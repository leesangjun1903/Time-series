# TSB-UAD: An End-to-End Benchmark Suite for Univariate Time-Series Anomaly Detection

### 1. 핵심 주장 및 주요 기여

**TSB-UAD**는 시계열 이상 탐지 분야의 **평가 기준의 부재**라는 근본적인 문제를 해결하기 위해 개발된 포괄적 벤치마크 스위트이다. 논문의 핵심 주장은 다음과 같다:[1]

기존 연구에서는 **독점적/합성 데이터** 또는 **제한된 공개 데이터셋**을 사용하여 평가하므로, 특정 데이터셋에서는 우수한 성능을 보이지만 다른 데이터셋에서는 저조한 성능을 나타낸다. 이는 진정한 방법론의 견고성을 판단하기 어렵게 만든다. 따라서 저자들은 과거 100개 이상의 논문을 검토하여 **13,766개의 라벨링된 시계열**을 수집, 처리, 통일된 형식으로 제공함으로써 신뢰할 수 있는 평가 환경을 구축했다.[1]

**주요 기여**는 다음과 같다:[1]

1. **공개 데이터셋 통합**: 18개의 기존 데이터셋(1,980개 시계열) 수집 및 통일된 형식으로 제공
2. **인공 데이터셋 생성**: 시계열 분류 데이터셋을 이상 탐지 데이터셋으로 변환(958개 시계열)
3. **합성 데이터셋**: 데이터 변환 기법을 적용하여 증강된 데이터셋(10,828개 시계열)
4. **평가 방법론**: 포괄적인 통계적 검증 및 난이도 평가 메트릭
5. **벤치마크 스위트**: 12개의 대표적 방법론에 대한 초기 평가 제공

***

### 2. 문제, 제안 방법, 모델 구조, 성능 및 한계

#### 2.1 해결하는 핵심 문제

시계열 이상 탐지의 평가에서 세 가지 주요 편향(bias)이 존재한다:[1]

**(1) 데이터셋 선택의 편향**: 제한된 데이터셋만 사용하면 특정 이상 유형(점 기반/연속 기반)만 평가되며, 일반화된 결론을 도출하기 어렵다.

**(2) 모델 파라미터 선택의 편향**: 데이터셋의 이상 밀도, 길이, 형식이 상이하여 동일한 파라미터 튜닝이 불가능하다.

**(3) 평가 메트릭 선택의 편향**: Precision/Recall, AUC, Range-based 메트릭 등이 서로 다른 결과를 제시할 수 있다.

#### 2.2 제안 방법

**데이터 변환 전략**:

시계열을 강화하기 위해 세 가지 유형의 변환을 사용한다:[1]

**(1) 전역 변환 (Global Transformations)**:

$$x'_i = x_i + p_{rw} \cdot s \cdot b_i \quad \text{(Random Walk)}$$

$$x'_i = x_i + p_{wn} \cdot s \cdot b_i \quad \text{where } b_i \sim N(0,1) \text{ (White Noise)}$$

$$x'_i = x_i + 5s \quad \text{(Point Outlier)}$$

$$X' = X * f = F^{-1}(F(X) \cdot F(f)) \quad \text{(Smoothing with Gaussian Filter)}$$

여기서 $s$는 표준편차, $p_{rw}$는 무작위 보행 강도, $p_{wn}$은 백색 잡음 강도이다.[1]

**(2) 지역 변환 (Local Transformations)**:

특정 구간에 대해 다음을 적용한다:[1]
- 패턴 관련: 평탄화, 반전, 정규화(z-score, MinMax, Tanh 등)
- 주파수 관련: 리샘플링

**(3) 부분수열 변환 (Subsequence Transformations)**:

분류 데이터셋의 클래스 라벨을 정상(Normal)과 이상(Abnormal)으로 분할한다. 최대 신장 트리(MST) 기반 접근법으로 유사 클래스를 구분:[1]

정상 세그먼트 수: $$N = K/r - K$$

비정상 세그먼트 수: $$K$$

이상 밀도: $$r$$ (파라미터)

#### 2.3 인공 데이터셋 생성 방법론

**혼동 행렬(Confusion Matrix) 기반 접근**:[1]

1. SBD(Shape-Based Distance) 거리를 사용하여 모든 클래스 간의 친화도(affinity) 행렬 계산
2. 1-NN 분류기로 혼동 인수 $$c_{jk}$$를 정의: $$P(\hat{y}=k|x)$$ (라벨 j가 라벨 k로 예측될 확률)
3. 정규화된 친화도: $$(c_{jk} + c_{kj})/2$$
4. 최대 신장 트리 구성으로 최대 전체 친화도 집합 생성
5. MST 인접 노드를 두 가지 색으로 칠하기 (정상/이상)

이 방법으로 생성된 시계열 중 **AUC > 0.65**를 만족하는 샘플만 유지하여 **자동 품질 필터링**을 수행한다.[1]

#### 2.4 평가 메트릭

TSB-UAD는 다양한 평가 메트릭을 포함한다:[1]

**(1) 기본 메트릭**:
- **Precision**: $$\text{Precision} = \frac{TP}{TP+FP}$$
- **Recall (TPR)**: $$\text{TPR} = \frac{TP}{TP+FN}$$
- **F-score**: $$F = \frac{2 \cdot \text{Precision} \cdot \text{Recall}}{\text{Precision}+\text{Recall}}$$
- **AUC**: ROC 곡선 아래의 면적

**(2) 범위 기반 메트릭**:
- **Range-Precision/Range-Recall**: 연속 이상 구간을 올바르게 감지하는 비율 측정[1]

**(3) 난이도 평가 메트릭**:

- **상대 대비도 (Relative Contrast, RC)**:
$$R_c = \frac{E_{s \in S}[D_{mean}(s)]}{E_{s \in S}[D_{min}(s)]}$$

RC는 1에 가까울수록 데이터가 균일하게 분포하여 클러스터링이 어렵다. RC가 작을수록 이상 탐지가 어렵다.[1]

- **정상점 클러스터링 정규화 (Normalized Clusteredness, NC)**:
$$N_c = \frac{E_{s_i, s_j \in S_{nor}}[D(s_i, s_j)]}{E_{s_i, s_j \in S_{ano}}[D(s_i, s_j)]}$$

NC > 1이면 이상점이 더 밀집되어 있어 탐지가 어렵다.[1]

- **정상/이상 클러스터 인접도 (Normalized Adjacency, NA)**:
$$N_a = \frac{\min_{c_i \in C_{ano}, c_j \in C_{nor}} D(c_i, c_j)}{E_{c_i, c_j \in C_{nor}}[D(c_i, c_j)]}$$

NA가 클수록 이상점이 정상 데이터에서 더 멀리 떨어져 있다.[1]

#### 2.5 평가 대상 방법론

12개의 대표적 방법론:[1]

| 카테고리 | 방법 | 특징 |
|---------|------|------|
| 근접도 기반 | Isolation Forest | 이진 트리 기반 이상도 계산 |
| | LOF | 지역 밀도 기반 |
| | HBOS | 히스토그램 기반 |
| 부분수열 기반 | Matrix Profile | 1-NN 거리 최대화 |
| | NORMA | 정상 패턴 클러스터링 |
| 통계 기반 | PCA | 저차원 투영 |
| | POLY | 다항식 근사 |
| 심층학습 | Autoencoder | 재구성 오차 |
| | LSTM-AD | RNN 예측 오차 |
| | CNN | CNN 예측 오차 |
| | OCSVM | 경계 학습 |

#### 2.6 성능 결과

**공개 데이터셋 평가 (18개 데이터셋)**:[1]

미세 분석(fine-grained)에서 **NORMA와 MP가 통계적으로 유의미하게 최상위** 성능을 보였다. 그러나 데이터셋 수준 집계 분석에서는 **NORMA가 1위, POLY, AE, IForest가 경쟁력 있는 성능**을 나타냈다.[1]

**이상 유형별 분석**:[1]

- **점 기반 이상**: CNN, LSTM이 우수 (평균 순위 1~2위)
- **연속 기반 이상**: NORMA, MP가 우수 (각 1~2위)

이는 **방법론의 편향성을 명확히 드러낸다**. 단일 데이터셋에서 최고 성능 방법도 다른 데이터셋에서는 현저히 저조할 수 있다.

**인공 데이터셋 평가 (126개 데이터셋)**:[1]

- **MP**: 평균 순위 1.18 (최상)
- **NORMA**: 평균 순위 2.37

**합성 데이터셋 평가 (92개 데이터셋)**:[1]

- **NORMA**: 평균 순위 1.48 (최상)
- **MP**: 평균 순위 2.17

데이터 변환 강도와 AUC의 상관관계:[1]
- 무작위 보행 배경, 백색 잡음: 강도 증가 → AUC 감소 (음의 상관)
- 평탄화: 명확한 상관 없음
- NC 증가 (이상점 클러스터링): AUC 27~31% 감소
- NA 증가 (정상과 이상 분리): AUC 20~45% 증가

#### 2.7 주요 한계점

**(1) 데이터 생성 편향**:

인공 데이터셋에서 MP가 우수한 이유는 **생성 방법의 구조적 편향** 때문이다. 비정상 클래스에서 1~2개 부분수열만 샘플링되고, 정상 클래스에서는 20개씩 샘플링되어 자동으로 **비정상점의 1-NN 거리가 더 크다**. 이는 MP 알고리즘의 설계와 우연히 일치하여 우수 성능을 초래했다.[1]

**(2) 반정감시 학습의 제약**:

LSTM-AD, AE, CNN, OCSVM은 이상 없는 훈련 데이터를 요구한다. KDD21, NASA-SMAP, NASA-MSL만 이를 제공하며, 다른 데이터셋은 초기 10% 또는 30%를 사용한다. **높은 이상 오염률이 있는 데이터셋에서는 성능 저하 가능성이 있다**.[1]

**(3) 파라미터 튜닝의 부재**:

연구에 사용된 파라미터는 기본값 또는 원래 논문에서 제시한 값이다. **더 정교한 튜닝은 성능 개선 여지를 의미한다**.[1]

**(4) 일반화 능력의 편차**:

점 기반 이상과 연속 기반 이상 간 방법론의 성능 순위가 완전히 반대이다. **한 유형에 최적화된 방법은 다른 유형에서 실패할 수 있다**.[1]

**(5) 변환의 한계**:

제시된 변환들은 시계열의 변동성 스펙트럼의 일부만 커버한다. Markov Switching 모델이나 매개변수 변화 모델 등 더 고급 변환은 향후 추가 계획이다.[1]

---

### 3. 일반화 성능 향상 가능성

#### 3.1 구조적 인사이트

**방법론별 강점 발현 조건**:[1]

1. **NORMA**: 여러 정상 패턴, 많은 이상 부분수열 환경에서 우수
2. **MP**: 이상이 희소하고 서로 다른 환경에서 우수
3. **CNN/LSTM**: 점 기반 이상 탐지에 특화

이는 **앙상블 기반 접근**의 가능성을 시사한다. 이상 유형을 먼저 분류하거나, 데이터 특성에 따라 적응적으로 방법론을 선택하면 일반화 성능을 향상시킬 수 있다.

#### 3.2 RC, NC, NA와 성능의 상관관계

**RC (상대 대비도)**: RC는 데이터셋의 전반적 클러스터링 정도를 측정한다. 작은 RC는 높은 어려움을 나타내며, 이는 방법론의 성능 저하와 연관된다.[1]

**NC (클러스터링 대비)**: NC > 1일 때 이상점이 더 밀집되어 있다.[1]
- NORMA의 AUC: NC 증가 시 25% 감소
- MP의 AUC: NC 증가 시 27% 감소
- IForest의 AUC: NC 증가 시 31% 감소

**NORMA는 NC에 상대적으로 안정적이므로 이상 클러스터링이 높은 환경에서 더 견고하다.**

**NA (인접도)**: NA가 증가하면 정상과 이상의 분리도가 증가한다.[1]
- IForest: AUC 20% 증가
- NORMA: AUC 45% 증가

**NORMA의 성능 상승이 더 크므로, 분리 가능한 데이터에 더 유리하다.**

#### 3.3 변환 강도와 견고성

**노이즈 추가**에서 AUC의 표준편차:[1]

AUC-ROC, F-score, Range-F-score가 가장 견고한 메트릭이다. 특히 **AUC-ROC는 임계값에 무관하므로 가장 신뢰성이 높다**.

**데이터 변환 강도 증가**:
- 무작위 보행, 백색 잡음: 강도 증가 → 일관된 AUC 감소
- 평탄화: 변환 강도와 AUC의 약한 상관

이는 **노이즈 강건성** 훈련이 일반화를 개선할 수 있음을 시사한다.

#### 3.4 개선을 위한 전략

**(1) 적응적 방법론 선택**:

데이터셋의 (RC, NC, NA) 값을 사전에 계산하여:
- NC가 높으면 NORMA 선택
- NA가 높으면 IForest 또는 NORMA 선택
- 점 기반 이상 가능성이 높으면 CNN/LSTM 선택

**(2) 앙상블 기반 접근**:

여러 방법론의 점수를 동적으로 가중치 부여하여 결합

**(3) 데이터 정규화**:

변환 강도가 높은 환경에서 견고한 특성 추출 기법 개발

**(4) 이상 유형 분류**:

사전 단계에서 이상 유형(점/연속)을 추정하고 해당 최적 방법론 적용

---

### 4. 학계 영향 및 향후 연구 방향

#### 4.1 TSB-UAD의 학계 기여

**신뢰할 수 있는 평가 표준 확립**:[1]

- 100개 이상 논문 검토 기반 설계
- 13,766개 다양한 시계열로 포괄적 평가 가능
- 공개 소스 제공으로 재현성 보장

**방법론의 한계 노출**:

연구는 "깊이 있는 학습 방법이 항상 최고"라는 통념을 깨뜨렸다. POLY나 NORMA 같은 단순한 방법이 CNN/LSTM보다 우수할 수 있다.[1]

**평가 편향의 자동 감지**:

RC, NC, NA 메트릭으로 데이터셋 난이도를 객관적으로 정량화할 수 있다.[1]

#### 4.2 향후 연구의 중요 고려 사항

**(1) 방법론 개발 시**:

- 단일 데이터셋이 아닌 **다양한 이상 유형에서의 견고성** 평가 필요
- 점 기반과 연속 기반 이상을 동시에 처리하는 **통합 방법론 개발**
- 높은 이상 오염률 환경에서의 성능 검증

**(2) 데이터셋 선정 시**:

- 애드혹한 데이터셋 선택이 아닌, **TSB-UAD와 같은 체계적 벤치마크 사용**
- 데이터셋의 (RC, NC, NA) 특성을 명시하여 재현성 향상

**(3) 모델 평가 시**:

- AUC, F-score, Range-F-score를 **함께 보고**
- 미세 분석과 집계 분석을 모두 수행
- 변환 강도 변화에 따른 **견고성 평가** 포함

**(4) 심층학습 모델**:

- **파라미터 튜닝의 정확한 기록**
- 이상 오염률 높은 환경에서의 훈련 전략 개발
- 비감시 학습 방향 탐색

**(5) 벤치마크 확장**:

- Markov Switching, 매개변수 변화 등 **고급 변환 추가**
- 다변량 시계열로 확대 (현재는 단변량 중심)
- 동적 임계값 설정 기법 통합

**(6) 실제 배포 고려**:

- 실시간 처리 성능(런타임) 평가 강화
- 메모리 효율성이 중요한 IoT 환경 대비

***

## 결론

**TSB-UAD**는 단순한 데이터셋 모음이 아닌, **시계열 이상 탐지의 평가 및 발전을 위한 종합적 프레임워크**이다. 이 논문이 학계에 미치는 영향은:[1]

1. **평가 기준의 민주화**: 어떤 방법론이 정말 견고한지 객관적으로 판단 가능
2. **편향 노출**: "단순한 방법이 복잡한 방법보다 나을 수 있다"는 중요한 교훈
3. **적응적 접근의 필요성**: 일원화된 '최고의 방법'보다 **데이터 특성에 따른 맞춤형 선택**의 중요성

향후 연구에서는 **RC, NC, NA 같은 난이도 메트릭을 활용한 적응적 알고리즘 선택**, **다양한 이상 유형의 동시 처리**, 그리고 **현실적 제약(낮은 계산 자원, 높은 이상 밀도)을 반영한 평가**가 핵심 과제가 될 것이다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/a7d198eb-123e-437f-8f59-38159fe5f533/3529337.3529354.pdf)
