# GANF : Graph-Augmented Normalizing Flows for Anomaly Detection of Multiple Time Series

### 1. 핵심 주장과 주요 기여[1]

이 논문은 **정규화 흐름(Normalizing Flows)**에 **베이지안 네트워크(Bayesian Network)** 기반의 그래프 구조 학습을 결합한 **GANF(Graph-Augmented Normalizing Flow)** 프레임워크를 제안합니다. 핵심 주장은 다중 시계열 데이터에서의 이상 탐지가 구성 시계열 간의 복잡한 상호 의존성을 모델링해야 하며, 이상점들은 확률 분포의 저밀도 영역에 나타난다는 가정입니다.[1]

**주요 기여:**
- 정규화 흐름에 그래프 구조 학습을 통합하여 다중 시계열의 상호 의존성을 모델링하는 프레임워크 제안[1]
- 비지도 방식의 이상 탐지 및 밀도 추정을 위한 광범위한 실증적 검증[1]
- 학습된 그래프 구조의 진화를 추적하여 분포 변화(distribution drift)를 식별하는 능력 시연[1]

---

### 2. 해결 문제, 제안 방법, 모델 구조 및 성능

#### 2.1 핵심 문제[1]

다중 시계열 이상 탐지는 세 가지 주요 도전과제를 가집니다:

- **고차원성**: 많은 구성 시계열을 단순히 연결하면 높은 차원의 데이터가 생성되어 학습이 어려워집니다.[1]
- **상호 의존성**: 구성 시계열 간의 암묵적이고 복잡한 인과 관계를 모델링해야 합니다.[1]
- **라벨 부족**: 라벨링이 비용이 크므로 비지도 학습이 필수적입니다.[1]

#### 2.2 제안 방법의 수학적 기초[1]

**베이지안 네트워크 기반 인수분해:**

베이지안 네트워크는 방향성 비순환 그래프(DAG)로서 변수들의 조건부 독립성을 모델링합니다. 결합 확률 밀도를 인수분해하면:

$$p(X_1, \ldots, X_n) = \prod_{i=1}^{n} p(X_i | \text{pa}(X_i))$$

여기서 $$\text{pa}(X_i)$$는 노드 $$X_i$$의 부모 집합입니다.[1]

**시간 차원 인수분해:**

시계열 데이터의 밀도는 시간 단계에 따른 조건부 확률의 곱으로 표현됩니다:

$$p(X) = \prod_{i=1}^{n} \prod_{t=1}^{T} p(x_t^i | \text{pa}(x)_{1:t}^i, x_{1:t-1}^i)$$

여기서 $$x_t^i$$는 시간 $$t$$에서의 $$i$$번째 시계열 값입니다.[1]

**조건부 정규화 흐름:**

조건부 정규화 흐름을 사용하여 각 조건부 밀도를 모델링합니다:

$$\log p(x_t^i | \text{pa}(x)_{1:t}^i, x_{1:t-1}^i) = \log q(f(x_t^i; d_t^i)) + \log |\det \nabla_{x_t^i} f(x_t^i; d_t^i)|$$

여기서 $$f$$는 가역 변환 함수이고, $$d_t^i$$는 의존성 표현입니다.[1]

#### 2.3 모델 구조[1]

**1) 의존성 인코더 (Dependency Encoder)**

- **RNN 모듈**: LSTM을 사용하여 시간 정보를 요약합니다:
  $$h_t^i = \text{RNN}(x_t^i, h_{t-1}^i)$$

- **그래프 컨볼루션 레이어**: 부모 노드들의 정보를 집계합니다:
  $$D_t = \text{ReLU}(AH_tW_1 + H_{t-1}W_2) \cdot W_3$$
  
  여기서 $$A$$는 인접 행렬, $$W_1, W_2, W_3$$는 학습 가능한 가중치 행렬입니다.[1]

**2) 정규화 흐름 모듈**

MAF(Masked Autoregressive Flow) 또는 RealNVP를 사용하여 조건부 밀도를 추정합니다.[1]

#### 2.4 결합 학습 알고리즘[1]

학습 목적함수는 다음의 제약 조건을 가진 최소화 문제입니다:

$$\min_{A,\theta} L(A, \theta) = -\frac{1}{|D|}\sum_{i=1}^{|D|} \log p(X_i)$$

$$\text{subject to: } h(A) = \text{tr}(e^{A \circ A}) - n = 0$$

여기서 DAG 제약 $$h(A) = 0$$은 인접 행렬이 실제로 비순환 그래프를 표현함을 보장합니다.[1]

**증강 라그랑주 방법**을 사용하여 최적화합니다:

$$L_c = L(A, \theta) + \lambda h(A) + \frac{c}{2}|h(A)|^2$$

반복마다 패널티 파라미터 $$c$$를 증가시켜 제약 조건이 점진적으로 만족되도록 합니다.[1]

***

### 3. 성능 향상 및 한계

#### 3.1 성능 향상[1]

**이상 탐지 성능 (AUC-ROC):**

| 데이터셋 | EncDecAD | DeepSVDD | ALOCC | DROCC | DeepSAD | GANF |
|---------|----------|----------|-------|-------|---------|------|
| PMU-B | 55.6% | 55.6% | 62.9% | 58.6% | 63.7% | **67.5%** |
| PMU-C | 53.7% | 56.9% | 60.9% | 61.9% | 60.1% | **70.6%** |
| SWaT | 76.5% | 68.8% | 75.4% | 73.3% | 75.4% | **79.6%** |

GANF는 모든 데이터셋에서 기존 방법들을 능가합니다.[1]

**제거 연구 (Ablation Study):**
- 독립 가정 변형(GANF\G): AUC 64.1% (PMU-B)
- 전체 분해 변형(GANF\D): AUC 63.0% (PMU-B)
- 별도 학습(GANF\T): AUC 66.1% (PMU-B)
- **결합 학습 GANF**: AUC **67.8%** (PMU-B)[1]

그래프 구조 학습과 결합 최적화의 중요성을 입증합니다.

#### 3.2 일반화 성능 향상의 근거[1]

**그래프 진화 분석**: 월별 데이터 이동에서 학습된 DAG의 변화를 추적하면서 분포 변화(distribution drift)의 패턴을 발견합니다. 특히 전력 그리드 데이터에서 계절성 패턴이 명확하게 나타나며, 이는 모델이 시간에 따른 시스템 역학 변화를 포착할 수 있음을 시사합니다.[1]

**밀도 추정의 품질**: 이상점들은 평균적으로 log-density ≈ 16 이하의 저밀도 영역에 집중되어 있으며, 정상 데이터는 고밀도 영역에 집중됩니다. 이는 밀도 기반 이상 탐지 가정의 타당성을 보여줍니다.[1]

#### 3.3 한계[1]

**1) 계산 복잡도**
- 전체 학습 시간 복잡도: $$O(n(BTD + BTn + n^2))$$
- 그래프 구조 학습은 계산상 도전적이며, 노드 수가 증가할수록 확장성 문제 발생[1]

**2) 데이터 요구사항**
- 충분한 정상 데이터가 필요한 비지도 학습 방식
- 라벨 노이즈에 민감할 수 있음 (PMU 데이터셋에서 노이즈 있는 라벨 처리)[1]

**3) 모델 해석성**
- 고차원 데이터에서 학습된 DAG의 인과 관계 해석에 어려움이 있을 수 있음
- 인접 행렬 $$A$$의 가중치가 연속 변수이므로 해석이 어려울 수 있음[1]

**4) 제약 조건의 만족**
- DAG 제약 $$h(A) = 0$$의 정확한 만족에 수렴 속도가 영향을 받을 수 있음
- 하이퍼파라미터 $$\eta$$, $$\gamma$$ 튜닝에 민감함[1]

***

### 4. 논문의 연구 영향 및 향후 고려사항

#### 4.1 연구에 미치는 영향[1]

**기술적 혁신:**
- 정규화 흐름과 구조 학습의 최초 결합으로, 기존 그래프 신경망 기반 접근과는 다른 확률 모델링 관점 제시[1]
- DAG 제약을 미분 가능한 형태로 표현하여 끝-대-끝 학습을 가능하게 함[1]
- 베이지안 네트워크의 인과 구조를 유지하면서도 밀도 기반 이상 탐지 가능[1]

**응용 분야:**
- 전력망, 물 처리 시설, 교통 시스템 등 인프라 모니터링 분야에서 실질적 가치[1]
- 분포 변화 감지를 통한 시스템 건강 상태 모니터링[1]

#### 4.2 향후 연구 고려사항[1]

**1) 확장성 개선**
- 더 큰 규모의 시계열(노드 수 > 200) 처리를 위한 효율적 알고리즘 개발
- 그래프 구조 학습의 계산 복잡도 완화 전략 필요

**2) 일반화 성능 강화**
- 도메인 적응 기법 통합으로 다양한 시스템 간 전이 학습 가능성 탐색
- 분포 변화에 강건한 모델 설계 (지속적 학습 또는 적응적 재훈련)

**3) 모델 해석성 향상**
- 학습된 그래프 구조와 시스템 물리적 성질 간의 관계 분석
- 인과 관계 검증을 위한 도메인 전문가 협업

**4) 하이브리드 접근**
- 알려진 시스템 구조 정보가 있을 경우 이를 선행 정보로 통합하는 방법
- 예: 전력망의 지리적 정보나 물리적 연결성을 고정 제약으로 추가

**5) 다양한 흐름 아키텍처 탐색**
- 최근 개발된 고급 정규화 흐름(Neural Spline Flows, Continuous Normalizing Flows) 적용
- 조건부 정보 차원에 따른 다양한 인코더 설계

**6) 반지도 학습 확장**
- 소량의 고품질 라벨 활용 가능성
- 약하게 지도된 이상 탐지 시나리오 대응

***

### 요약

GANF는 **정규화 흐름의 밀도 추정 능력**과 **베이지안 네트워크의 인과 모델링**을 결합하여 다중 시계열 이상 탐지 문제의 복잡한 도전을 체계적으로 해결합니다. 특히 그래프 구조 학습의 미분 가능한 공식화와 결합 최적화는 기술적으로 우수하며, 실증적 성능 향상이 분명합니다. 다만 계산 복잡도, 라벨 노이즈 민감성, 해석성 측면에서의 한계를 고려하여 향후 연구 방향을 설정해야 하며, 특히 도메인 적응과 효율성 개선이 실제 대규모 응용을 위한 핵심 과제입니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/2c102590-e513-4cf7-a596-667fddb583de/2202.07857v2.pdf)
