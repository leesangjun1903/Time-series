# Z-GCNETs: Time Zigzags at Graph Convolutional Networks for Time Series Forecasting

### 1. 핵심 주장 및 주요 기여[1]

Z-GCNETs는 시간 영역의 위상학적 정보를 그래프 신경망에 통합한 첫 번째 접근법입니다. 본 논문의 핵심 기여는 다음과 같습니다:

**주요 혁신:**
- **시간 조건부 위상학적 정보의 통합**: 현존하는 대부분의 심층학습 구조는 정적이지만, Z-GCNETs는 명시적인 시간 차원을 학습 메커니즘의 기본 구성 요소로 통합합니다.
- **Zigzag Persistence Image(ZPI) 도입**: 시간 인식형 위상 특성의 새로운 벡터화 요약을 제안하고 이론적 안정성 보장을 제공합니다.
- **시간 인식형 Zigzag 위상 계층 개발**: GCN에 학습 가능한 위상 계층을 삽입하여 시간 변화하는 위상 특성을 추적합니다.

**실험 성과**: 4개 벤치마크 데이터셋(PeMSD4, PeMSD8, Bytom, Decentraland)에서 13개의 최신 방법들을 능가하며, 정확도와 견고성 모두에서 우수한 성능을 입증했습니다.[1]

---

### 2. 문제 정의 및 해결 방법

#### 2.1 해결하고자 하는 문제[1]

실제 현상은 본질적으로 동적이며, 대부분의 심층학습 아키텍처는 시간 차원을 체계적으로 통합하지 못합니다. 이로 인해:
- 복잡한 상호의존 시스템의 시간 조건부 특성을 안정적으로 학습할 수 없음
- 자주 갱신이 필요한 오래된 결정 생성
- 공간-시간 상관관계를 기능 수준과 사전정의된 그래프 구조 측면에서만 모델링

Z-GCNETs는 **시간 영역의 위상적 불변성**을 활용하여 이러한 문제를 해결합니다. Zigzag persistence는 경곡선, 신축, 압축 같은 연속 변환에 불변인 데이터 특성을 추출할 수 있습니다.[1]

#### 2.2 제안 방법 및 수식

**2.2.1 Laplacianlink 표현**[1]

정규화된 라플라시안의 거듭제곱을 스택하여 다층적 이웃 정보를 누적:

$$
\mathcal{L} = [I, L, L^2, \ldots, L^K] \in \mathbb{R}^{N \times N(K+1)}
$$

여기서 $$I$$는 항등행렬, $$L$$은 정규화된 라플라시안, $$L^k$$는 $$k$$차 거듭제곱입니다.[1]

**2.2.2 공간 그래프 합성곱**[1]

$$
H_{\ell,S}^i = \mathcal{L}H_{\ell-1,S}^i \Theta V
$$

여기서:
- $$\Theta \in \mathbb{R}^{N \times c}$$: 노드 임베딩
- $$V \in \mathbb{R}^{c(K+1) \times C_{in} \times C_{out}}$$: 학습 가능한 가중치
- $$H_{\ell,S}^i \in \mathbb{R}^{N \times C_{in}}$$: $$\ell$$번째 계층의 활성화 행렬

**2.2.3 시간 그래프 합성곱**[1]

$$
H_{\ell,T}^i = \mathcal{L}H_{\ell-1,T}^i U \circledast Q
$$

여기서:
- $$U \in \mathbb{R}^{c \times C_{in} \times C_{out}}$$: 학습 가능한 가중치
- $$Q \in \mathbb{R}^{\tau \times 1}$$: 시간 그래프 합성곱 계층의 학습 가능한 투영 벡터
- $$\circledast$$: 콘볼루션 연산을 나타냅니다.

**2.2.4 Zigzag Persistence Image (ZPI) 계산**[1]

세 단계로 ZPI를 계산합니다:

**Step 1**: Zigzag persistence diagram를 적분 가능한 함수(zigzag persistence surface)로 변환:

$$
\Phi_{\text{DgmZZ}}(z) = \sum_{(x,y) \in \text{DgmZZ}} g(z) \exp\left(-\frac{\|z - (x,y)\|^2}{2\sigma^2}\right)
$$

**Step 2**: 격자에서 지역별 적분을 수행하여 ZPI 행렬의 픽셀값 계산:

$$
\text{ZPI}(z) = \int_z \int_{\text{DgmZZ}} g(z-w) \exp\left(-\frac{\|z-w\|^2}{2\sigma^2}\right) dz_x dz_y
$$

**Step 3**: 결과적으로 얻어진 행렬이 ZPI로 사용되며, 이는 크기 p×p의 2D 이미지 형태입니다.[1]

**2.2.5 Time-aware Zigzag 위상 계층**[1]

$$
Z = \max(f_{\text{cnn}}(\text{ZPI}))
$$

$$
\mathcal{S}_{\ell}^i = H_{\ell,S}^i \odot Z
$$

$$
\mathcal{T}_{\ell}^i = H_{\ell,T}^i \odot Z
$$

$$
H_{\ell,\text{out}}^i = \text{COMBINE}(\mathcal{S}_{\ell}^i, \mathcal{T}_{\ell}^i)
$$

여기서:
- $$f_{\text{cnn}}$$: CNN 기반 특성 추출
- $$\max$$: 전역 최대 풀링 연산
- $$\odot$$: 요소별 곱셈
- $$Z \in \mathbb{R}^{C_{out}}$$: CNN에서 학습된 zigzag 위상 표현[1]

**2.2.6 GRU와 Zigzag 위상 계층의 통합**[1]

$$
z^i = \sigma(W^z [O^{i-1}, H_{\ell,\text{out}}^i] + b^z)
$$

$$
r^i = \sigma(W^r [O^{i-1}, H_{\ell,\text{out}}^i] + b^r)
$$

$$
O^i = \tanh(W^o [r^i \odot O^{i-1}, H_{\ell,\text{out}}^i] + b^o)
$$

$$
O^i = z^i \odot O^{i-1} + (1 - z^i) \odot O^i
$$

여기서 $$z^i$$와 $$r^i$$는 각각 업데이트 게이트와 리셋 게이트입니다.[1]

**2.2.7 이론적 안정성 보장 (Proposition 3.1)**[1]

ZPI가 Zigzag persistence diagram들 간의 Wasserstein-1 거리에 대해 안정적입니다:

> ZPI는 zigzag persistence diagram의 작은 변화에 대해 안정적인 벡터 표현을 제공합니다.

이는 ZPI가 작은 위상 변화에도 견고한 특성을 유지함을 의미합니다.[1]

***

### 3. 모델 구조

#### 3.1 전체 아키텍처[1]

Z-GCNETs는 다음과 같은 구조로 구성됩니다:

1. **Zigzag Persistence 계산**: 시간 윈도우 내의 동적 네트워크로부터 ZPI 추출
2. **CNN 기반 특성 학습**: ZPI에서 위상 특성을 CNN으로 학습 (2개 CNN 계층, 필터 8개, 커널 크기 3×3, stride 2)
3. **공간 그래프 합성곱**: 현재 시점의 노드 특성 변환
4. **시간 그래프 합성곱**: 슬라이딩 윈도우 전체에서 시간 상관관계 포착
5. **특성 통합**: 위상 정보와 공간-시간 특성 결합
6. **GRU 모듈**: 최종 예측 수행

#### 3.2 핵심 컴포넌트[1]

**Laplacianlink**: 정규화 라플라시안의 다차 거듭제곱 $$L, L^2, \ldots, L^K$$를 연결하여 다양한 깊이의 이웃 정보를 누적하는 확산 형식입니다.

**공간 그래프 합성곱**: 단일 시점 $$t$$에서 노드의 공간적 의존성을 모델링합니다. 가중치 공유를 통해 과적합을 방지합니다.

**시간 그래프 합성곱**: 전체 슬라이딩 윈도우 $$\tau$$를 입력으로 사용하여 시간 상관관계 패턴을 포착합니다.

**Time-aware Zigzag 위상 계층**: CNN을 통해 ZPI에서 위상 특성을 학습하고, 전역 최대 풀링으로 대표 특성을 추출한 후 공간-시간 정보와 결합합니다.[1]

---

### 4. 성능 향상 및 일반화

#### 4.1 정확도 개선[1]

**교통 데이터셋 (PeMSD4, PeMSD8)**:

| 모델 | PeMSD4 RMSE | PeMSD8 RMSE | 개선도 |
|------|-------------|-------------|--------|
| AGCRN (이전 최고) | 32.30 | 25.22 | - |
| Z-GCNETs | 31.61 | 25.11 | 0.44-2.06 RMSE 감소[1] |

**이더리움 토큰 네트워크**:

| 모델 | Bytom MAPE | Decentraland MAPE |
|------|-----------|------------------|
| AGCRN | 34.46 | 26.75 |
| Z-GCNETs | 31.04 | 23.81 |

Z-GCNETs은 Bytom과 Decentraland에서 각각 3.42와 2.94의 MAPE 개선율을 보였습니다.[1]

#### 4.2 견고성 (Robustness) 개선[1]

**가우시안 노이즈 추가 실험** (훈련 데이터의 30%에 노이즈 추가):

| 데이터셋 | 노이즈 레벨 | AGCRN | LSGCN | Z-GCNETs |
|---------|-----------|-------|-------|----------|
| Decentraland | N(0,2) | 27.69 | 36.10 | 24.12 |
| Decentraland | N(0,4) | 28.12 | 36.79 | 25.03 |
| PeMSD4 | N(0,2) | 32.24 | 34.16 | 31.95 |
| PeMSD4 | N(0,4) | 32.67 | 34.75 | 32.18 |

Z-GCNETs는 모든 노이즈 조건에서 일관되게 더 견고한 성능을 유지합니다.[1]

#### 4.3 일반화 성능 분석

**4.3.1 Ablation Study (제거 연구)**[1]

각 컴포넌트의 중요성을 정량화:

**PeMSD4 데이터셋**:
- 기본 모델 RMSE: 31.61
- Zigzag 학습 제거: 31.94 (0.95% 증가)
- 공간 GCN 제거: 31.96 (1.10% 증가)
- 시간 GCN 제거: 33.18 (4.95% 증가) - **가장 큰 영향**

**PeMSD8 데이터셋**:
- 기본 모델 RMSE: 25.11
- Zigzag 학습 제거: 27.06 (7.76% 증가)
- 공간 GCN 제거: 26.86 (6.96% 증가)
- 시간 GCN 제거: 26.44 (5.30% 증가)

시간 그래프 합성곱이 가장 중요한 컴포넌트임을 알 수 있으며, 특히 다단계 예측 작업에서 시간 정보의 중요성이 입증되었습니다.[1]

**4.3.2 Zigzag 위상 특성의 영향**[1]

**0차 vs 1차 위상 특성**:

| 특성 | PeMSD4 RMSE | PeMSD8 RMSE |
|-----|-------------|-------------|
| 0차 ZPI (δ=0.3) | 32.04 | 27.24 |
| 1차 ZPI (δ=0.3) | 31.66 | 25.11 |
| 0차 ZPI (δ=0.5) | 32.20 | 27.41 |
| 1차 ZPI (δ=0.5) | 31.61 | 26.62 |

**1차 위상 특성(순환 및 공동, cycles and voids)이 0차 특성(연결 성분)보다 지속적으로 우수한 성능**을 보입니다. 이는 더 복잡한 위상 구조가 시간 시계열의 동적 패턴을 더 잘 포착함을 의미합니다.[1]

**4.3.3 필터링 방법의 선택**[1]

다양한 Zigzag 필터링 방법의 성능:

| 필터링 방법 | Bytom MAPE | Decentraland MAPE |
|-----------|-----------|------------------|
| Weight rank clique | 30.80 | 22.15 |
| Weighted-degree sublevel | 30.56 | 25.18 |
| Power filtration | 30.79 | 22.15 |

**결론**: 희소 그래프(Bytom)에서는 모든 필터링이 유사한 결과를 제공하지만, 더 복잡한 위상 구조를 가진 그래프(Decentraland)에서는 power filtration이 기저 그래프 조직의 진화를 더 잘 포착합니다.[1]

#### 4.4 일반화 성능 향상의 근거

**1. 위상학적 불변성**: Zigzag persistence는 연속 변환에 불변인 데이터 특성을 추출하므로, 작은 노이즈나 데이터 변동에 강합니다.

**2. 다중 스케일 정보**: Laplacianlink의 거듭제곱 스택은 다양한 깊이의 이웃 정보를 누적하여 다중 스케일 특성을 학습합니다.

**3. 가중치 공유**: 행렬 인수분해에서 가중치 공유를 사용하여 과적합을 감소시키고 계산 복잡도를 줄입니다.

**4. 시간 인식형 설계**: 시간 변화하는 네트워크의 위상 특성을 명시적으로 추적하여 동적 시스템의 특성을 더 잘 포착합니다.

***

### 5. 제한사항 및 한계

#### 5.1 명시적 한계[1]

**1. 계산 복잡도**: 
- Zigzag filtration의 계산이 필수적이며, PeMSD4에서 슬라이딩 윈도우당 0.86초 소요
- 대규모 동적 네트워크에서는 계산 시간이 상당할 수 있음

**2. 필터링 방법의 민감성**:
- Zigzag 필터링 방법의 선택이 성능에 영향을 미침
- 각 데이터셋에 최적의 필터링 파라미터(δ, K 등)를 수동으로 조정해야 함

**3. 스케일 파라미터 선택**:
- ZPI 계산에서 격자 크기(grid size, 100×100 사용)와 가우시안 함수의 분산(σ)을 수동으로 설정
- 데이터셋 특성에 따라 최적 파라미터가 다를 수 있음

**4. 제한된 실험 범위**:
- 2개 유형의 동적 네트워크(교통 네트워크, 이더리움 토큰 네트워크)에서만 검증
- 다른 유형의 시계열(금융 예측, 센서 데이터 등)에서의 성능은 미지수

#### 5.2 암묵적 한계[1]

**1. 이더리움 토큰 네트워크의 제약**:
- 거대한 이더리움 블록체인 네트워크를 최대 가중치 부분그래프 근사법으로 축소(N=100)
- 정보 손실의 가능성이 있으며, 실제 네트워크 구조가 완전히 반영되지 않을 수 있음

**2. 비교 기준의 제한**:
- 일부 비교 모델(GraphWaveNet)이 다른 모델들보다 성능이 낮음
- 최신 트랜스포머 기반 시계열 모델과의 비교 부재

**3. 시간 윈도우 크기 고정**:
- PeMSD 데이터셋에서 윈도우 크기 12, Ethereum에서 7로 고정
- 다양한 시간 스케일에서 최적 성능을 찾기 위한 자동화된 방법 없음

---

### 6. 향후 연구에 미치는 영향과 고려사항

#### 6.1 연구 분야에의 긍정적 영향[1]

**1. 위상 데이터 분석(TDA)과 심층학습의 통합**:
- 본 논문은 Zigzag persistence를 심층학습에 처음 적용한 사례로, 위상학적 정보를 신경망에 통합하는 새로운 패러다임을 제시합니다.
- GCN뿐만 아니라 다른 심층학습 아키텍처에도 확장될 가능성이 높습니다.

**2. 시간 조건부 표현 학습**:
- DARPA의 "시간 인식형 심층학습 메커니즘" 개발 요청에 대응하여, 명시적 시간 차원을 학습의 기본 구성 요소로 통합하는 방향을 제시합니다.

**3. 동적 네트워크 분석의 확장**:
- 시간 변화하는 그래프 구조의 특성을 추적하는 새로운 방법을 제공하여, 생물 시스템, 뇌 네트워크, 소셜 네트워크 분석에 응용될 수 있습니다.

#### 6.2 향후 연구 시 고려할 점[1]

**1. 파라미터 자동화**:
- Zigzag 필터링 방법, 스케일 파라미터(δ), Laplacianlink 차수(K) 등을 자동으로 선택하는 메커니즘 개발
- 신경 아키텍처 탐색(NAS) 기법 활용

**2. 확장성 개선**:
- 대규모 동적 네트워크에 대한 Zigzag persistence 계산의 효율화
- GPU 병렬 처리 또는 근사 알고리즘 개발

**3. 다양한 응용 분야 탐색**:
- 금융 시계열(주가, 암호화폐 가격)
- 생물 시스템(단백질 상호작용 네트워크, 신경망)
- 센서 네트워크의 이상 탐지
- 기후 및 환경 데이터 예측

**4. 이론적 분석 강화**:
- Zigzag persistence 안정성 보장과 실제 성능 개선의 정량적 연관성 분석
- 다양한 그래프 유형에 대한 수렴성 증명 및 복잡도 분석

**5. 하이브리드 접근법**:
- 어텐션 메커니즘(Attention)과의 결합: 시간 단계별 중요도 가중치 학습
- 트랜스포머 기반 구조와의 통합: 전역 시간 의존성 모델링

**6. 전이 학습 및 도메인 적응**:
- 한 교통 네트워크에서 학습한 모델을 다른 지역으로 전이
- 도메인 간 Zigzag 위상 특성의 일반화 가능성 검증

#### 6.3 실무 적용 시 권장사항

**1. 데이터 전처리**:
- 시간 윈도우 크기와 예측 지평선의 최적화는 각 응용에서 필수
- Min-max 정규화 외에 다양한 정규화 기법 시도

**2. 모델 선택 가이드**:
- 상대적으로 작은 네트워크(N < 500): 전체 모델 사용 권장
- 대규모 네트워크: 부분그래프 샘플링 또는 계층적 집계 고려

**3. 성능 평가**:
- 교통 예측: MAE, RMSE, MAPE 사용
- 금융 데이터: 방향성 정확도(Directional Accuracy), Sharpe Ratio 추가 고려
- 노이즈 견고성 검증: 의도적으로 노이즈를 추가한 테스트셋에서 평가

***

### 결론

Z-GCNETs는 **위상학적 정보와 시간 차원을 체계적으로 통합**하여 시공간 시계열 예측에 새로운 정조건부 표현 학습 패러다임을 제시합니다. Zigzag persistence의 안정성 보장과 실험적 견고성 개선은 이론과 실무의 교집합에서 의미 있는 기여를 합니다. 다만, 계산 복잡도와 파라미터 최적화 자동화라는 과제를 해결한다면, 더 광범위한 응용 분야로의 확대와 함께 위상 데이터 분석과 심층학습의 통합 연구에 강한 자극제 역할을 할 것으로 예상됩니다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/3097b52e-4126-46f8-bd29-d670e0cc2c87/2105.04100v1.pdf)
