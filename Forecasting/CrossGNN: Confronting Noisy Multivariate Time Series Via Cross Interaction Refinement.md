# CrossGNN: Confronting Noisy Multivariate Time Series Via Cross Interaction Refinement

**핵심 주장**  
CrossGNN은 예기치 않은 노이즈가 가득한 실세계 다변량 시계열(MTS) 데이터에서 기존 Transformer 및 GNN 기반 모델들이 시간·변수 차원의 상호작용을 제대로 다루지 못한다는 문제를 지적하고, 선형(complexity = O(L)) 계산량을 가지는 새로운 GNN 구조를 제안하여 **크로스-스케일(Cross-Scale)** 및 **크로스-변수(Cross-Variable)** 상호작용을 정제함으로써 예측 성능과 노이즈 내성 모두를 크게 향상시킨다.[1]

**주요 기여**  
1. 실세계 MTS 데이터 분석을 통해 시간 차원의 세분화 스케일 간 노이즈 강도 차이와 변수 간 동질성·이질성 관계의 존재를 체계적으로 규명.  
2. **AMS-Identifier(AMSI)**: FFT 기반으로 최상위 주파수에 대응하는 기간 길이를 적응적으로 식별·추출하여 다중 스케일 시계열을 구성.[1]
3. **Cross-Scale GNN**: 스케일별 노드 간 정규화된 연관 그래프를 학습하여 노이즈에 강한 스케일 간·스케일 내 상호작용을 모듈식으로 캡처(식 6–10).[1]
4. **Cross-Variable GNN**: 변수 간 동질(positive)·이질(negative) 관계를 분리 학습하여 노이즈 불변성을 갖는 변수 상호작용을 모델링(식 11–13).[1]
5. Direct multi-step forecasting을 위한 MLP 디코더 도입으로 예측 단계 단순화 및 일괄 예측 지원(식 14).[1]
6. 8개 실세계 데이터셋에서 64개 설정 중 47회 1위, 9회 2위 달성, 평균 MSE –10.43%, MAE –10.11% 개선.[1]

***

## 문제 정의

다변량 시계열 예측 시  
- **시간 차원 노이즈**: Transformer의 self-attention이 이상치에 과도 반응하여 시계열 예측의 불안정성을 초래.  
- **변수 차원 이질성**: 변수 간 복잡·동적 상호작용이 노이즈에 의해 왜곡되어 정확한 상관관계 학습이 어려움.  

따라서 노이즈에 강인한 스케일별·변수별 정제된 상호작용 모델이 요구된다.[1]

***

## 제안 방법 상세

### 1. Adaptive Multi-Scale Identifier (AMSI)  
- FFT로 각 변수의 주파수 스펙트럼을 구하고, 상위 S개 주파수 $$f_s$$를 선택(식 1–2).  
- 해당 주파수에 대응하는 기간 $$p_s = \tfrac{L}{f_s}$$로 AvgPool downsampling 수행하여 $$X_s$$ 획득(식 3–4).  
- 모든 스케일 시계열을 연결하여 다중 스케일 시계열 $$X\in \mathbb R^{L\times D\times C}$$ 생성(식 5).[1]

### 2. Cross-Scale GNN  
- 노이즈 저항적 스케일 간 그래프 $$G_\text{scale}=(V_\text{scale},E_\text{scale})$$ 정의.  
- 학습 가능한 두 벡터로 초기화 후 ReLU-Softmax를 통해 상관 계수 행렬 $$\widetilde{E}_\text{scale}$$ 생성(식 6).  
- 스케일 민감 제한 및 트렌드 인접 노드 유지(식 7–8), 중요 엣지만 보존하며 재정규화(식 9).  
- GNN 메시지 패싱으로 N층 학습하여 스케일 간 정보 융합(식 10).[1]

### 3. Cross-Variable GNN  
- 변수 노드 집합 $$V_\text{var}$$에서 학습 가능한 두 벡터로 초기 상관 행렬 $$\widetilde{E}_\text{var}$$ 구축(식 11).  
- 상위 K₁ 동질 이웃과 하위 K₂ 이질 이웃 분리, 각각 양·음 가중치로 재정규화(식 12).  
- 동질·이질 메시지 패싱을 통합하여 변수 상호작용 특징 학습(식 13).[1]

### 4. Direct Multi-Step Forecasting  
- MLP 두 단계: 시계열 차원 C→1 축소, 과거 L→미래 T 일괄 예측(식 14).[1]

***

## 성능 향상 및 한계

- 8개 데이터셋 64 설정 중 47회 1위, 평균 MSE –10.43%, MAE –10.11% 향상.[1]
- **노이즈 내성**: SNR 100 dB→0 dB 구간에서 MSE 증가폭이 ETSformer·MTGNN 대비 현저히 완만(0.177 vs. 0.191 vs. 0.205)로 견고성 확인.[1]
- **복잡도**: CrossGNN 전체 모듈 시간·공간 복잡도가 $$O(L)$$로 확장성 우수.[1]
- **한계**: Electricity 데이터셋에서 OOD(out-of-distribution) 심화로 일반화 성능 저하 관찰. 동적 분포 변동에 대한 추가 기법 필요.[1]

***

## 일반화 성능 향상 관점

CrossGNN은  
- 스케일별 노드 연결 가중치를 노이즈 강도에 따라 재조정함으로써 이상치 의존도 감소.  
- 변수별 동질·이질 관계를 분리하여 본질적 상관관계만 학습, 분포 불일치에도 내성 보유.  
- AM‐SI의 주파수 기반 스케일링이 외인성 노이즈를 효과적으로 분리하여 일반화 역치 확장.  
이러한 구조적 설계가 다양한 예측 길이, 데이터셋, SNR 환경에서도 일관된 성능 유지에 기여한다.[1]

***

## 향후 연구 영향 및 고려 사항

이 논문은 **노이즈 정제**와 **상호작용 분리 학습** 관점에서 시계열 예측 연구에 다음과 같은 영향을 미친다.  
- **동적 그래프 네트워크 설계**: 분포 변동이 심한 OOD 상황에서도 적응형 엣지 업데이트가 가능한 동적 GNN 구조 연구 필요.  
- **스케일 선택 최적화**: AMSI에서 S, K 하이퍼파라미터를 자동 튜닝하거나 메타러닝으로 학습하는 방법 고안.  
- **OOD 일반화 전략**: 강화 학습 또는 도메인 적응 기법을 통합하여 전이 성능을 강화.  
- **경량화 및 실시간 예측**: 엣지 수와 스케일 수를 최소화하면서도 성능 보장을 위한 효율적 서브그래프 추출 기법 연구.  

이와 같은 방향은 CrossGNN의 노이즈-강건 예측 패러다임을 확장하며, 실제 운용 환경에서의 일반화·확장성 문제를 해결하는 데 기여할 것이다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/3d2d1459-d09d-47a5-a9a6-f0afc8ecffcd/NeurIPS-2023-crossgnn-confronting-noisy-multivariate-time-series-via-cross-interaction-refinement-Paper-Conference.pdf)
