
# Evolving Multi-Scale Normalization for Time Series Forecasting under Distribution Shifts

## 1. 핵심 주장과 주요 기여

EvoMSN(Evolving Multi-Scale Normalization)은 시계열 예측에서 복잡한 분포 이동(distribution shift) 문제를 해결하기 위한 모델 독립적(model-agnostic) 프레임워크입니다. 이 논문의 핵심 주장은 기존 정규화 방법들이 단일 스케일에서만 분포 동역학을 모델링하여 다양한 시간적 스케일의 복잡한 분포 변화를 포착하지 못한다는 것입니다.[^1_1]

**주요 기여:**

- 다중 스케일 통계 예측 모듈을 통한 복잡한 분포 동역학 모델링
- 적응형 앙상블 전략을 활용한 다중 스케일 예측 출력 통합
- 통계 예측 모듈과 백본 예측 모델을 협력적으로 업데이트하는 진화적 이중 레벨 최적화 전략
- Exchange 데이터셋에서 평균 MSE 11.30%, Weather 데이터셋에서 55.09% 감소 등 주요 성능 향상 달성[^1_1]


## 2. 상세 분석

### 해결하고자 하는 문제

**핵심 문제점:**

1. **다중 스케일 분포 동역학 무시:** 기존 방법들(RevIN, Dish-TS, SAN)은 인스턴스 레벨 또는 단일 스케일에서만 분포를 모델링하여, 시간별(hourly), 일별(daily), 주별(weekly) 등 다양한 시간적 스케일의 분포 변화를 포착하지 못합니다.[^1_1]
2. **점진적 분포 이동 처리 한계:** 조건부 분포 $P(Y|X)$가 시간에 따라 변화하는 상황에서, 기존 오프라인 정규화 방법들은 입력-출력 관계의 변화에 적응하지 못합니다 [^1_1].

### 제안하는 방법

#### 다중 스케일 분포 동역학 모델링

**전역 주기성 추출:**

Fast Fourier Transform(FFT)을 통해 전역 주기성을 발견합니다:

$$
A = \text{Avg}(\text{Amp}(\text{FFT}(X))), \quad \{f_1, \cdots, f_k\} = \arg \text{Top}_k(A), \quad p_i = \left\lfloor \frac{t}{f_i} \right\rfloor
$$

여기서 $A$는 평균 진폭, $\{f_1, \cdots, f_k\}$는 상위 k개의 주파수, $\{p_1, \cdots, p_k\}$는 해당 주기 길이입니다.[^1_1]

**다중 스케일 슬라이스 기반 통계:**

발견된 주기성에 따라 입력/출력 윈도우를 비중첩 슬라이스로 분할합니다:

$$
X^{(i)} = \text{Slicing}_{p_i}(\text{Padding}(X)), \quad Y^{(i)} = \text{Slicing}_{p_i}(\text{Padding}(Y))
$$

각 슬라이스의 평균과 표준편차를 계산합니다:

$$
\mu_j^{(i),n} = \frac{1}{p_i}\sum_{t=1}^{p_i} x_{j,t}^{(i),n}, \quad (\sigma_j^{(i),n})^2 = \frac{1}{p_i}\sum_{t=1}^{p_i}(x_{j,t}^{(i),n} - \mu_j^{(i),n})^2
$$

$$
\phi_j^{(i),n} = \frac{1}{p_i}\sum_{t=1}^{p_i} y_{j,t}^{(i),n}, \quad (\xi_j^{(i),n})^2 = \frac{1}{p_i}\sum_{t=1}^{p_i}(y_{j,t}^{(i),n} - \phi_j^{(i),n})^2
$$

**다중 스케일 통계 예측 모듈:**

미래 슬라이스의 분포를 예측하기 위해 각 주기성에 대해 별도의 2층 퍼셉트론 네트워크를 구축합니다:

$$
\hat{\phi}^{(i)} = f_{\omega_i}(\mu^{(i)}, x), \quad \hat{\xi}^{(i)} = f_{\theta_i}(\sigma^{(i)}, x)
$$

여기서 $f_{\omega_i}$와 $f_{\theta_i}$는 각각 평균과 표준편차 통계를 모델링하는 예측 모델입니다.[^1_1]

#### 적응형 앙상블을 활용한 정규화/역정규화

**정규화:**

각 슬라이스를 해당 통계로 정규화합니다:

$$
\tilde{x}_j^{(i),n} = \frac{1}{\sigma_j^{(i),n} + \varepsilon} * (x_j^{(i),n} - \mu_j^{(i),n})
$$

**역정규화:**

예측된 통계로 백본 모델의 출력을 역정규화합니다:

$$
\hat{y}_j^{(i),n} = \tilde{y}_j^{(i),n} * (\hat{\xi}_j^{(i),n} + \varepsilon) + \hat{\phi}_j^{(i),n}
$$

**다중 스케일 적응형 앙상블:**

지역 진폭에 기반한 가중치로 다중 스케일 출력을 앙상블합니다:

$$
\hat{y}_n = \sum w^{(i),n} * \hat{y}^{(i),n}, \quad w^{(i),n} = \frac{A^{(i),n}}{\sum_{i=1}^k A^{(i),n}}
$$

여기서 $A^{(i),n} = \text{Amp}_{\{f_1,\cdots,f_k\}}(\text{FFT}(x_n))$는 지역 진폭입니다.[^1_1]

### 모델 구조

EvoMSN 프레임워크는 세 가지 주요 구성 요소로 이루어져 있습니다:

1. **주기성 추출 모듈:** FFT를 통해 k개의 지배적인 주기를 식별합니다
2. **다중 스케일 통계 예측 모듈:** 각 주기성에 대해 독립적인 경량 2층 퍼셉트론 네트워크를 사용하여 미래 통계를 예측합니다
3. **백본 예측 모델:** DLinear, Autoformer, FEDformer, PatchTST, TimesNet 등 임의의 시계열 예측 모델을 사용할 수 있습니다[^1_1]

**학습 전략 - 진화적 이중 레벨 최적화:**

```math
\min_{\psi} \sum_{n=1}^N L((x_n, y_n), \psi|\omega^*, \theta^*)
```

subject to:

```math
\omega^*, \theta^* = \arg\min_{\omega,\theta} \sum_{n=1}^N \sum_{i=1}^k L_{\text{stat}}^i((x_n, y_n), \psi, \omega_i, \theta_i)
```

**오프라인 2단계 사전학습:**

- 1단계: 통계 예측 모듈만 학습 $\ell((\hat{\phi}^{(i)}, \hat{\xi}^{(i)}), (\phi^{(i)}, \xi^{(i)}))$
- 2단계: 통계 예측 모듈 고정 후 백본 모델 학습 $\ell(\hat{y}_n, y_n)$

**온라인 교대 업데이트:**

- 백본 모델 고정 → 통계 예측 모듈 업데이트: $\nabla_{\omega,\theta}L((x_n, y_n), \psi, \omega, \theta)$
- 통계 예측 모듈 고정 → 백본 모델 업데이트: $\nabla_{\psi}L((x_n, y_n), \psi, \omega, \theta)$[^1_1]


### 성능 향상

**온라인 예측 결과:**

- Exchange: TimesNet 기준 MSE 평균 11.30% 감소
- Traffic: TimesNet 기준 MSE 평균 12.77% 감소
- Electricity: TimesNet 기준 MSE 평균 31.74% 감소
- Weather: TimesNet 기준 MSE 평균 55.09% 감소
- ETTh1: TimesNet 기준 MSE 평균 28.41% 감소[^1_1]

**기존 온라인 학습 전략 대비 우수성:**

- Online-TCN 대비 65.90% 개선
- Experience Replay(ER) 대비 63.89% 개선
- FSNet 대비 63.01% 개선[^1_1]

**정규화 방법 비교:**
EvoMSN은 SAN, RevIN, Dish-TS 등 최신 정규화 방법들보다 일관되게 우수한 성능을 보였습니다. 특히 SAN은 단일 스케일만 고려하는 반면, EvoMSN은 다중 스케일 접근으로 더 나은 결과를 달성했습니다.[^1_1]

### 한계점

1. **빠른 통계 변화 포착 한계:** 온라인 예측 설정에서 각 새 데이터마다 통계 예측 모듈이 한 번만 업데이트되어 빠르게 변하는 통계를 포착하기 어려울 수 있습니다[^1_1]
2. **훈련 데이터 비율 의존성:** 온라인 설정에서 상대적으로 작은 훈련 데이터로 전역 주기성을 결정하여 부적절한 주기성 추출이 발생할 수 있습니다[^1_1]
3. **평균과 분산만 고려:** 최소값, 최대값 등 더 포괄적인 분포 특성을 무시하여 분포 동역학 모델링이 제한적입니다[^1_1]
4. **Stability-Plasticity Dilemma:** 온라인 업데이트 시 백본 모델과 통계 예측 모듈이 안정성-가소성 딜레마를 겪을 수 있습니다[^1_1]
5. **계산 복잡도:** 고려하는 주기성의 수만큼 백본 모델의 복잡도가 증가하여 계산 부담이 발생합니다. 저주파수 예측 시나리오(일별 전력 수요 예측 등)에서는 허용 가능하지만, 고주파수 환경에서는 문제가 될 수 있습니다[^1_1]

## 3. 모델의 일반화 성능 향상 가능성

### 다중 스케일 모델링의 일반화 효과

**스케일 수 민감도 분석:**
실험 결과 K=1(단일 스케일)에서 K=4(다중 스케일)로 증가 시:

- Exchange 데이터셋: 평균 MSE 23.82% 감소
- ETTm1 데이터셋: 평균 MSE 12.64% 감소[^1_1]

이는 다중 스케일 접근이 다양한 시간적 패턴을 포착하여 일반화 성능을 크게 향상시킴을 보여줍니다.

### 오프라인 장기 예측에서의 일반화

EvoMSN을 오프라인 설정(온라인 업데이트 없이)에서 평가한 결과:

- DLinear: 평균 15.03% 개선
- Autoformer: 평균 25.60% 개선
- FEDformer: 평균 22.62% 개선
- PatchTST: 평균 4.05% 개선
- TimesNet: 평균 7.77% 개선[^1_1]

특히 Exchange, ETTh2, ILI 같은 고도로 비정상적인 데이터에서 효과가 두드러졌습니다. 이는 다중 스케일 정규화(MSN)가 훈련-테스트 데이터 간 분포 불일치를 완화하여 일반화 능력을 향상시킴을 입증합니다.[^1_1]

### 모델 독립적(Model-Agnostic) 특성

EvoMSN은 5개의 다양한 백본 모델(선형 모델, 트랜스포머, CNN)에서 일관되게 성능을 향상시켰습니다. 이는 프레임워크가 특정 모델 아키텍처에 의존하지 않고 일반화 성능을 개선할 수 있음을 의미합니다.[^1_1]

### 대규모 데이터에서의 일반화

San Diego 교통 데이터(716개 센서, 2019년)에서의 실험 결과:

- LSTM: 평균 RMSE 18.94% 감소
- STGCN: 평균 RMSE 10.08% 감소
- GWNET: 평균 RMSE 7.3% 감소[^1_1]

대규모 다변량 시계열에서도 일관된 성능 향상을 보여 실제 응용에서의 일반화 가능성을 확인했습니다.

## 4. 연구의 영향과 향후 고려사항

### 연구에 미치는 영향

**1. 다중 스케일 분포 모델링의 새로운 패러다임**

EvoMSN은 시계열 분포 이동 문제를 다중 스케일 관점에서 접근하는 새로운 패러다임을 제시했습니다. 이는 향후 연구에서 단일 스케일 접근의 한계를 인식하고 다양한 시간적 해상도를 고려하는 방향으로 발전할 것입니다.[^1_1]

**2. 모델 독립적 프레임워크의 실용성**

백본 모델과 독립적으로 작동하는 플러그 앤 플레이 방식은 기존 시계열 예측 시스템에 쉽게 통합될 수 있어, 실무 적용 가능성이 높습니다.[^1_1]

**3. 온라인-오프라인 통합 접근**

오프라인 사전학습과 온라인 교대 학습을 결합한 진화적 최적화 전략은 비정상성과 점진적 분포 이동을 동시에 처리하는 새로운 학습 패러다임을 제공합니다.[^1_1]

### 향후 연구 시 고려할 점

**1. 더 포괄적인 분포 특성 모델링**

현재 EvoMSN은 평균과 분산만 사용합니다. 향후 연구에서는:

- 최소값, 최대값, 중앙값 등 추가 통계량 통합
- 고차 모멘트(왜도, 첨도) 고려
- 분포의 전체 형태를 모델링하는 생성 모델 접근[^1_1]

**2. 적응형 주기성 선택**

현재는 전역 FFT로 고정된 k개의 주기를 선택합니다. 개선 방향:

- 지역적 시간 창에서 동적으로 주기성 업데이트
- 어텐션 메커니즘을 통한 주기의 중요도 자동 학습
- 웨이블릿 변환 등 다중 해상도 분석 기법 통합[^1_2]

**3. 계산 효율성 향상**

- 다중 스케일 분석의 병렬화
- 중요 분포 이동 감지 시에만 선택적 업데이트하는 적응형 전략
- 경량 통계 예측 모듈 설계[^1_1]

**4. Stability-Plasticity 균형**

지속 학습(Continual Learning) 기법 통합:

- 경험 재생(Experience Replay) 강화
- 메타 학습을 통한 빠른 적응
- 정규화 기반 접근(EWC, SI)[^1_3][^1_4]


## 2020년 이후 관련 최신 연구 비교 분석

### 정규화 기반 접근

**GAS-Norm (2024)**[^1_5]

GAS(Generalized Autoregressive Score) 모델과 딥러닝을 결합하여 각 새 관측치에서 평균과 분산을 추정하는 점수 기반 적응 정규화를 제안했습니다. EvoMSN과의 주요 차이점:

- GAS-Norm은 단일 스케일 자기회귀 모델 사용
- EvoMSN은 다중 스케일 명시적 모델링
- GAS-Norm은 통계적 모델에 기반, EvoMSN은 신경망 기반 통계 예측[^1_5]

**RevIN (2021)**[^1_1]

인스턴스 레벨 정규화로 입력 윈도우 전체의 통계를 사용합니다. EvoMSN 대비:

- 윈도우 내 분포 변화 무시
- 다중 스케일 동역학 미포착
- Exchange 데이터에서 EvoMSN이 RevIN 대비 약 40% 성능 향상[^1_1]

**SAN (2024)**[^1_1]

슬라이스 기반 정규화로 윈도우를 더 세밀한 단위로 분할합니다. 한계점:

- 단일 정적 스케일만 고려
- 사전 정의된 슬라이스 길이에 의존
- EvoMSN의 적응형 다중 스케일 앙상블 부재[^1_1]


### 온라인 학습 접근

**FSNet (2022)**[^1_4]

Fast and Slow 학습 네트워크로 Complementary Learning Systems 이론에 영감을 받아 빠른 적응과 점진적 학습을 결합했습니다:

- 어댑터를 통한 빠른 적응
- 연관 메모리를 통한 반복 패턴 기억
- 단기 예측에 효과적이지만 장기 예측에서 성능 저하
- EvoMSN-TCN이 FSNet 대비 63.01% MSE 감소[^1_4][^1_1]

**NatSR (2026)**[^1_3]

Natural Score-driven Replay를 제안하여:

- 자연 경사 하강을 점수 기반 방법으로 재구성
- Student's t 분포로 이상치 강건성 향상
- 동적 스케일 휴리스틱으로 체제 전환 시 빠른 적응

EvoMSN과의 차이: NatSR은 최적화 관점, EvoMSN은 분포 동역학 모델링 관점[^1_3]

### 분포 이동 일반화

**ShifTS Framework (2024)**[^1_6]

개념 표류(Concept Drift)와 시간적 이동(Temporal Shift)을 구분하여:

- Soft Attention Masking(SAM)으로 외생 변수의 불변 패턴 활용
- 시간적 이동을 선행 처리로 다룸

EvoMSN과의 관계: 두 접근 모두 분포 이동의 다양한 형태를 인식하지만, ShifTS는 외생 변수에, EvoMSN은 내재적 다중 스케일 동역학에 집중[^1_6]

**IN-Flow (2025)**[^1_7]

Instance Normalization Flow로:

- 특정 통계에 의존하지 않는 분포 변환
- 정규화 흐름(normalizing flow)을 통한 유연한 분포 변환

EvoMSN 대비 더 일반적이지만 계산 비용이 높고, 다중 스케일 명시적 모델링은 없음[^1_7]

### 테스트 시간 적응

**TSF-TTA / TAFAS (2025)**[^1_8]

테스트 시간 적응(Test-Time Adaptation) 프레임워크로:

- 사전학습된 모델을 지속적으로 변화하는 테스트 분포에 적응
- 사전학습 시 학습한 핵심 의미 정보 보존

EvoMSN의 온라인 교대 학습과 유사하지만, TAFAS는 레이블 없는 테스트 데이터 적응에 초점[^1_8]

### 다중 스케일 및 분해 접근

**DUET (2025)**[^1_9]

Dual Clustering Enhanced 접근으로:

- 시간적 패턴의 이질성과 채널 간 복잡한 상관관계 해결
- 이중 클러스터링을 통한 시간적 및 채널별 패턴 포착

EvoMSN의 다중 스케일과 보완적이지만, DUET는 클러스터링에, EvoMSN은 주기성 기반 분할에 집중[^1_9]

**Wavelet-based Disentangled Adaptive Normalization (2025)**[^1_2]

웨이블릿 변환을 사용하여:

- 이산 웨이블릿 변환으로 다양한 시간적 스케일의 구성 요소 분리
- 비정상성의 기저 구조 드러냄

EvoMSN과 유사한 다중 스케일 철학이지만, FFT 대신 웨이블릿 사용[^1_2]

### 종합 비교표

| 방법 | 다중 스케일 | 온라인 학습 | 모델 독립성 | 통계 예측 | 주요 강점 |
| :-- | :-- | :-- | :-- | :-- | :-- |
| **EvoMSN (2024)** | ✓ | ✓ | ✓ | ✓ | 다중 스케일 분포 동역학 + 진화적 최적화 [^1_1] |
| GAS-Norm (2024) | ✗ | ✓ | ✓ | ✓ | 통계적 점수 기반 적응 [^1_5] |
| RevIN (2021) | ✗ | ✗ | ✓ | ✗ | 단순하고 효과적인 인스턴스 정규화 [^1_1] |
| SAN (2024) | 단일 | ✗ | ✓ | ✓ | 슬라이스 기반 세밀한 정규화 [^1_1] |
| FSNet (2022) | ✗ | ✓ | ✗ | ✗ | 빠른/느린 이중 학습 시스템 [^1_4] |
| IN-Flow (2025) | ✗ | ✗ | ✓ | ✗ | 일반적 분포 변환 [^1_7] |
| ShifTS (2024) | ✗ | ✓ | ✓ | ✗ | 개념 표류 vs 시간적 이동 구분 [^1_6] |
| TAFAS (2025) | ✗ | ✓ | ✓ | ✗ | 테스트 시간 적응 [^1_8] |
| Wavelet-based (2025) | ✓ | ✗ | ✓ | ✗ | 웨이블릿 다중 해상도 분석 [^1_2] |

### 향후 통합 방향

1. **웨이블릿과 FFT 결합:** EvoMSN의 FFT 기반 주기 추출을 웨이블릿 변환과 결합하여 더 유연한 다중 스케일 분해[^1_2]
2. **테스트 시간 적응 통합:** EvoMSN의 온라인 학습에 TAFAS의 테스트 시간 적응 전략 통합하여 레이블 없는 환경 대응[^1_8]
3. **점수 기반 최적화:** GAS-Norm의 통계적 엄밀함과 NatSR의 자연 경사 하강을 EvoMSN의 통계 예측 모듈에 적용[^1_5][^1_3]
4. **개념 표류 명시적 처리:** ShifTS의 개념 표류 감지 메커니즘을 EvoMSN의 다중 스케일 프레임워크와 결합[^1_6]

EvoMSN은 다중 스케일 분포 동역학 모델링과 진화적 최적화를 결합한 독창적 접근으로, 시계열 예측의 분포 이동 문제 해결에 중요한 기여를 했으며, 향후 연구는 이를 기반으로 더 포괄적이고 계산 효율적인 방법론으로 발전할 것으로 전망됩니다.
<span style="display:none">[^1_10][^1_11][^1_12][^1_13][^1_14][^1_15][^1_16][^1_17][^1_18][^1_19][^1_20][^1_21][^1_22][^1_23][^1_24][^1_25]</span>

<div align="center">⁂</div>

[^1_1]: 2409.19718v1.pdf

[^1_2]: https://arxiv.org/pdf/2506.05857.pdf

[^1_3]: https://www.arxiv.org/abs/2601.12931

[^1_4]: https://arxiv.org/abs/2202.11672

[^1_5]: https://arxiv.org/html/2410.03935

[^1_6]: https://arxiv.org/html/2510.14814v1

[^1_7]: https://arxiv.org/pdf/2401.16777.pdf

[^1_8]: https://arxiv.org/pdf/2501.04970.pdf

[^1_9]: https://arxiv.org/html/2412.10859v1

[^1_10]: https://arxiv.org/pdf/2411.05793.pdf

[^1_11]: http://arxiv.org/pdf/2310.07446.pdf

[^1_12]: https://arxiv.org/html/2410.13253v2

[^1_13]: http://arxiv.org/pdf/2406.09130.pdf

[^1_14]: http://arxiv.org/pdf/2405.13522.pdf

[^1_15]: https://pdfs.semanticscholar.org/d0d4/2fa6fb4ab0650854f8f8080f7b7c8a4dd88a.pdf

[^1_16]: https://arxiv.org/html/2512.03122v1

[^1_17]: https://arxiv.org/html/2503.23604v2

[^1_18]: https://arxiv.org/pdf/2304.11213.pdf

[^1_19]: https://arxiv.org/pdf/2203.09474.pdf

[^1_20]: https://arxiv.org/pdf/2308.13222.pdf

[^1_21]: https://pdfs.semanticscholar.org/fb76/33dcdeb50f0abdd840d44e23e4afa44a2fde.pdf

[^1_22]: https://arxiv.org/html/2503.23604v4

[^1_23]: https://www.biorxiv.org/content/10.1101/2024.09.13.612861v1.full.pdf

[^1_24]: https://arxiv.org/pdf/2307.09543.pdf

[^1_25]: https://arxiv.org/html/2401.16777v1

