# ST-Norm: Spatial and Temporal Normalization for Multi-variate Time Series Forecasting

### 1. 핵심 주장과 주요 기여

ST-Norm 논문의 중심 주장은 **다변량 시계열(MTS) 데이터의 비정상성(non-stationarity)을 해결하기 위해 공간과 시간 차원의 정규화를 분리하여 적용하는 것이 효과적**이라는 것입니다. 논문의 주요 기여는 다음과 같습니다.[1]

먼저 논문은 실제 MTS 데이터가 **4가지 유형의 영향(impact)**의 혼합으로 생성된다고 주장합니다: 저빈도 국소(local low-frequency), 저빈도 전역(global low-frequency), 고빈도 국소(local high-frequency), 고빈도 전역(global high-frequency). 예를 들어 뉴욕시 자전거 수요 데이터에서 시간대는 전역 고빈도, 지역 정체성은 국소 저빈도 영향을 미칩니다.[1]

논문은 기존 심층학습 아키텍처(LSTM, Transformer, WaveNet 등)가 **공간 구분불가능성(spatial indistinguishability)과 시간 구분불가능성(temporal indistinguishability)** 문제를 가진다고 분석합니다. 이는 모델이 전역 고빈도 성분만 포착하고 다른 성분들을 무시하기 때문입니다.[1]

이를 해결하기 위해 논문은 **두 가지 정규화 모듈**을 제안합니다: 시간 정규화(Temporal Normalization, TN)는 고빈도 성분을 추출하고, 공간 정규화(Spatial Normalization, SN)는 국소 성분을 추출합니다. 이 접근 방식의 주요 장점은 계산 복잡도가 $$O(NT)$$로 유지되면서(그래프 기반 방법은 $$O(N^2T)$$), 최첨단 성능을 달성한다는 점입니다.[1]

***

### 2. 해결하는 문제와 제안 방법

#### 2.1 핵심 문제

MTS 데이터는 식 (1)로 표현되는 4개 성분의 합으로 구성됩니다:[1]

$$
X_{i,t} = X^{lh}_{i,t} \cdot X^{ll}_{i,t} \cdot X^{gh}_{t} \cdot X^{gl}_{t} + \text{const}
$$

여기서 $$X_{i,t}$$는 i번째 시계열의 시간 t에서의 값입니다.[1]

기존 모델들은 동적 벡터의 **방향 정보만 포착**하여 다른 성분들을 누락합니다. 논문은 식 (2)를 통해 이를 수학적으로 보여줍니다:[1]

$$
\frac{X_{i,t_0}}{\sqrt{\sum_{t'=0}^{\delta-1}(X_{i,t-t'})^2}} \approx \frac{X^{gh}_{i,t_0}}{\sqrt{\sum_{t'=0}^{\delta-1}(X^{gh}_{i,t-t'})^2}}
$$

이로 인해 모델이 **평균 특성만 학습**하고 개별 샘플(특히 장꼬리 분포의 샘플)을 제대로 구분하지 못합니다.[1]

#### 2.2 시간 정규화(TN)

TN은 고빈도 성분을 추출하여 공간 구분을 개선합니다. 핵심 아이디어는 **저빈도 성분이 일정 기간 동안 거의 상수**라는 가정에 기반합니다.[1]

고빈도 성분을 추출하는 공식은:[1]

$$
Z^{high}_{i,t} = \frac{Z_{i,t} - E[Z_{i,t}|\text{low}]}{\sigma[Z_{i,t}|\text{low}] + \epsilon} \gamma^{high}_i + \beta^{high}_i
$$

여기서 평균과 표준편차는 다음과 같이 근사됩니다:[1]

$$
E[Z_{i,t}|\text{low}] \approx \frac{1}{\delta}\sum_{t'=1}^{\delta} Z_{i,t-t'+1}
$$

$$
\sigma^2[Z_{i,t}|\text{low}] \approx \frac{1}{\delta}\sum_{t'=1}^{\delta}(Z_{i,t-t'+1} - E[Z_{i,t}|\text{low}])^2
$$

여기서 $$\delta$$는 입력 시간 스텝 수입니다. TN은 이미지 처리의 인스턴스 정규화와 유사하지만, 시계열의 맥락에서 유도됩니다.[1]

#### 2.3 공간 정규화(SN)

SN은 국소 성분을 추출하기 위해 전역 성분을 제거합니다. 핵심 가정은 **전역 영향이 모든 시계열에 유사한 효과를 미친다**는 것입니다.[1]

국소 성분을 추출하는 공식은:[1]

$$
Z^{local}_{i,t} = \frac{Z_{i,t} - E[Z_{i,t}|\text{global}]}{\sigma[Z_{i,t}|\text{global}] + \epsilon} \gamma^{local} + \beta^{local}
$$

평균과 표준편차는 다음과 같이 계산됩니다:[1]

$$
E[Z_{i,t}|\text{global}] \approx \frac{1}{N}\sum_{j=1}^{N} Z_{j,t}
$$

$$
\sigma^2[Z_{i,t}|\text{global}] \approx \frac{1}{N}\sum_{j=1}^{N}(Z_{j,t} - E[Z_{i,t}|\text{global}])^2
$$

여기서 N은 시계열 변수의 개수입니다.[1]

#### 2.4 모델 구조

ST-Norm은 WaveNet 백본을 기반으로 구축되며, 각 잔차 블록에서 확장 인과 합성곱(dilated causal convolution, DCC) 전에 TN과 SN을 적용합니다. 아키텍처는 다음 요소들로 구성됩니다:[1]

- 확장 인과 합성곱: $$F(t) = \sum_{i=0}^{k-1} f(i) \cdot z_{t-d \cdot i}$$로 정의되며, 확장 계수 d가 지수적으로 증가하여 넓은 수용 영역을 확보합니다[1]
- ST-Norm 모듈: TN과 SN을 병렬로 적용
- 시간 풀링 블록: 각 변수에 대해 시간 집계 수행
- 완전 연결 층: 각 변수에 대한 별도의 예측 생성[1]

---

### 3. 성능 향상 분석

실험은 3개 데이터셋(BikeNYC, PeMSD7, Electricity)에서 수행되었습니다.[1]

**BikeNYC 데이터셋**에서 Wavenet + STN은 기존 최고 성능 모델 대비:[1]
- 1시간 예측: MAPE +2.8%, MAE +4.7%, RMSE +5.8%
- 2시간 예측: MAPE +2.1%, MAE +3.5%, RMSE +4.1%
- 3시간 예측: MAPE +0.9%, MAE +3.2%, RMSE +2.8%

**PeMSD7 데이터셋**에서:[1]
- 30분 예측: MAPE +3.2%, MAE +3.4%, RMSE +3.0%
- 60분 예측: MAPE +3.8%, MAE +3.9%, RMSE +1.7%
- 90분 예측: MAPE +4.1%, MAE +4.0%, RMSE +2.9%

**Electricity 데이터셋**에서:[1]
- 1시간 예측: MAPE -11.0%, MAE +1.2%, RMSE +4.9%
- 2시간 예측: MAPE +4.4%, MAE +9.4%, RMSE +8.8%
- 3시간 예측: MAPE +10.4%, MAE +11.5%, RMSE +9.8%

절제 연구(Ablation Study)에서는 TN과 SN이 각각 개별적으로 성능 개선에 기여함을 보였고, 그래프 학습 모듈과 결합해도 ST-Norm이 더 우월함을 나타냈습니다.[1]

***

### 4. 모델의 일반화 성능

#### 4.1 하이퍼파라미터 안정성

ST-Norm은 **다양한 하이퍼파라미터 설정에서 안정적인 성능**을 보입니다. 그림 6에서 보듯이:[1]

- 숨겨진 채널 차원($$d_z$$): 4~64 범위에서 안정적
- 입력 시간 스텝: 4~64 범위에서 꾸준한 개선
- 커널 크기: 변화에 강건함
- 배치 크기: 8 이상에서 안정적

이는 기존 WaveNet과 비교했을 때 ST-Norm이 하이퍼파라미터 선택에 덜 민감함을 의미합니다.[1]

#### 4.2 다양한 데이터 분포에 대한 강건성

Electricity 데이터셋은 **장꼬리 분포**를 가지고 있어, MAPE 지표에서 1시간 예측 시 성능 저하가 발생합니다. 논문은 이를 다음과 같이 분석합니다:[1]

> "MSE 최소화는 큰 오류에 더 많은 가중치를 부여하므로 모델이 장꼬리 샘플을 더 잘 피팅하지만, 정상 샘플에서 성능이 저하됩니다"[1]

그럼에도 불구하고 2~3시간 예측에서는 최고 성능을 달성하여, **일반적인 범위의 샘플에 대해서는 우수한 일반화 능력**을 보입니다.[1]

#### 4.3 장기 의존성 모델링

수렴 곡선 분석에서 ST-Norm은 **빠른 수렴 속도**를 보입니다. 이는 다음을 시사합니다:[1]

- 정규화 모듈이 특징 공간의 **계수 증가(rank enhancement)**를 통해 학습 효율 개선
- 더 다양한 특징 추출로 인한 더 빠른 최적화
- 특히 WaveNet의 확장 합성곱과 조합될 때 효과적

#### 4.4 구간-특정 일반화

사례 연구(Case Study)에서:

- **SN 적용 후**: 동일 지역의 인스턴스가 t-SNE 시각화에서 군집을 형성하여 지역 정체성이 보존됨[1]
- **TN 적용 후**: 동일 시간의 인스턴스가 지역 관계없이 군집을 형성하여 시간 특성이 명확히 구분됨[1]

이는 **각 정규화 모듈이 특정 차원의 신호를 효과적으로 분리**하고 있음을 보여줍니다.

***

### 5. 모델의 한계

#### 5.1 이론적 한계

**독립성 가정의 한계**: 정의 2와 가정 1에서 네 성분이 **상호 독립**이라고 가정하지만, 현실에서는 완벽한 독립이 드뭅니다. 예를 들어, 지역적 특성과 시간대 영향이 상호작용할 수 있습니다.[1]

**저빈도 성분의 안정성 가정**: TN은 저빈도 성분이 $$\delta$$ 기간 동안 거의 상수라고 가정하지만, 주기성이나 트렌드가 길수록 이 가정이 위반됩니다.[1]

#### 5.2 실험적 한계

**장꼬리 분포 데이터의 MAPE 성능**: Electricity 데이터셋의 첫 번째 예측 지평에서 MAPE가 -11.0% 저하됩니다. 이는 논문이 지적한 대로, 모든 샘플을 동등하게 취급하기 때문입니다.[1]

**그래프 구조 미활용**: BikeNYC와 PeMSD7 데이터의 공간적 관계를 고려하지 않아, 그래프 기반 방법이 활용할 수 있는 추가 정보를 사용하지 않습니다.[1]

**제한된 데이터셋 범위**: 실험이 교통 및 에너지 데이터에 집중되어, 금융 시계열이나 센서 기반 데이터 등 다른 도메인의 일반화 성능이 검증되지 않았습니다.[1]

#### 5.3 계산 효율성의 한계

ST-Norm의 $$O(NT)$$ 복잡도는 그래프 기반 방법의 $$O(N^2T)$$보다 우월하지만:[1]

- **메모리 비용**: 모든 샘플의 전역 통계를 계산하고 저장해야 함
- **배치 크기 의존성**: 하이퍼파라미터 분석에서 배치 크기가 8 미만일 때 성능 저하[1]
- **대규모 N에 대한 확장성**: N이 매우 큰 경우 전역 통계 계산의 효율성이 감소

---

### 6. 미래 연구에 미치는 영향과 고려사항

#### 6.1 긍정적 영향

**정규화 관점의 확장**: ST-Norm은 시계열에서 정규화의 역할을 새로운 관점에서 조명합니다. 이는 배치 정규화, 계층 정규화, 그룹 정규화 등 다른 정규화 기법의 시계열 응용을 촉발할 수 있습니다.[1]

**아키텍처 독립성**: TN과 SN이 WaveNet, Transformer, TCN 등 다양한 백본에 적용 가능하다는 점은 **모듈화 가능성**을 시사합니다.[1]

**해석 가능성 향상**: 성분 분해 접근법이 시계열 예측의 해석 가능성을 개선할 수 있습니다.

#### 6.2 향후 연구 시 고려사항

**1. 성분 분해의 정교화**

- 4가지 성분이 완전히 정의되지 않은 경우에 대한 적응적 분해 방법 개발
- 성분 간 상호작용 모델링 연구
- 비선형 성분 상호작용 처리

**2. 이론적 기초 강화**

- 독립성 가정을 완화한 일반화 이론 개발
- 언제 ST-Norm이 효과적인지에 대한 성능 보장(PAC 학습 등) 연구
- 다양한 시계열 통계 특성에 따른 성능 분석

**3. 장꼬리 분포 처리**

- 가중 손실 함수와 ST-Norm의 결합
- 견고한 통계량 사용 (예: 중앙값, 로버스트 표준편차)
- 정규분포 가정을 완화한 정규화 변형

**4. 도메인 특화 연구**

- 금융 시계열(주식, 암호화폐)에서의 성능 평가
- 의료 센서 데이터, IoT 데이터 등 다양한 도메인 적용
- 계절성과 트렌드가 강한 데이터에 대한 최적화

**5. 공간적 정보 통합**

- SN과 그래프 신경망의 효과적인 결합 방식 연구
- 공간-시간 정규화의 계층적 구조 개발
- 동적 그래프에서의 ST-Norm 적용

**6. 효율성 개선**

- 배치 정규화로의 전환을 통한 GPU 최적화
- 온라인 학습 환경에서의 ST-Norm 구현
- 대규모 다변량 시계열(N >> 1000)에 대한 스케일링

**7. 다중 스케일 분석**

- 서로 다른 주기성을 가진 성분의 분리
- 웨이블릿 분해와 ST-Norm의 결합
- 계층적 시간 스케일에서의 정규화

#### 6.3 실무 적용 시 권장사항

논문의 결과를 실제 응용에 적용할 때는 다음을 고려해야 합니다:

- **데이터 전처리**: ST-Norm 전에 이상치 제거 및 결측값 처리 필수
- **하이퍼파라미터 튜닝**: 특히 배치 크기 선택에 주의 (≥8 권장)
- **지표 선택**: MAPE가 장꼬리 분포에서 불안정하므로, RMSE나 MAE를 우선 고려
- **검증 전략**: 시계열 특성에 맞는 교차 검증 방식 사용 (시간순 분할 권장)

이 논문은 MTS 예측의 정규화 기법에 중요한 통찰을 제공하며, 향후 연구의 확장성과 실무 적용 가능성이 높은 주요 기여로 평가됩니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/de473a32-c9dd-49ff-a92b-5e6bd56e7cd6/3447548.3467330.pdf)
