# CausalGNN: Causal-Based Graph Neural Networks for Spatio-Temporal Epidemic Forecasting

## 1. 핵심 주장 및 주요 기여

**CausalGNN**은 전통적인 그래프 신경망(GNN)의 한계를 극복하기 위해 인과 관계 기반 메커니즘을 명시적으로 통합한 새로운 학습 프레임워크입니다. 논문의 핵심 주장은 다음과 같습니다.[1]

기존 심층학습 모델들, 특히 GNN은 대규모 통계 특성을 학습하지만 질병 전파의 기저 인과 메커니즘을 명시적으로 포함하지 못합니다. CausalGNN은 **잠재 공간에서 그래프 입력 특성과 역학(epidemiological) 문맥을 상호 학습 메커니즘을 통해 결합**함으로써 이 문제를 해결합니다.[1]

주요 기여는 다음과 같습니다:[1]

- **시공간 잠재 공간 학습 프레임워크**: 그래프 기반 비선형 변환을 이용하여 시공간 및 인과 임베딩을 통합
- **주의 기반 동적 GNN(ADGNN) 모듈**: 질병 역학의 공간 및 시간 신호를 효율적으로 캡처
- **인과 모듈의 통합**: 상미분방정식(ODE)을 통해 질병 모델 파라미터를 제공하면서 계산 효율성 달성
- **반복적 피드백 메커니즘**: 인과 인코더와 인과 디코더를 설계하여 두 모듈 간의 상호작용 지원

실험 결과, CausalGNN은 전역(Global), 미국 주(State), 미국 카운티(County) 수준에서 COVID-19 예측에서 최대 7% 성능 개선을 달성했습니다.[1]

***

## 2. 문제 설정, 제안 방법, 모델 구조 및 성능

### 2.1 해결하고자 하는 문제

전염병 예측에는 세 가지 주요 도전 과제가 있습니다:[1]

**첫째, 네트워크 기반 구획 모델의 한계**: 높은 지리적 해상도(예: 3,000+ 미국 카운티)에서 시간 변동 파라미터를 교정하는 것이 계산량 측면에서 비효율적입니다.[1]

**둘째, 심층학습 모델의 과적합 위험**: 전염병 데이터는 교통 데이터보다 희소하고 노이즈가 많아 기존 시공간 예측 모델들이 과적합되는 경향이 있습니다.[1]

**셋째, 역학적 문맥의 부재**: 대부분의 심층학습 기반 전염병 예측 모델은 질병 모델(예: SIR)의 파라미터와 특성과 같은 역학적 문맥을 명시적으로 포함하지 않으며, 이로 인해 특히 노이즈가 많고 희소한 데이터에서 장기 예측 성능이 저하됩니다.[1]

### 2.2 제안하는 방법 및 수식

CausalGNN은 두 개의 주요 모듈로 구성됩니다:[1]

**인과 모듈**: 각 지역에 대해 단일 구획 SIRD(Susceptible-Infected-Recovered-Deceased) 모델을 실행합니다. SIRD 역학은 다음 차분 방정식으로 정의됩니다:[1]

$$
\Delta S_i(t + 1) = -\beta_i(t)\frac{S_i(t)I_i(t)}{N_i}
$$

$$
\Delta I_i(t + 1) = \beta_i(t)\frac{S_i(t)I_i(t)}{N_i} - \gamma_i(t)I_i(t) - \rho_i(t)I_i(t)
$$

$$
\Delta R_i(t + 1) = \gamma_i(t)I_i(t)
$$

$$
\Delta D_i(t + 1) = \rho_i(t)I_i(t)
$$

여기서 $$q_{i,t}: S_i(t), I_i(t), R_i(t), D_i(t)$$는 각 상태의 누적 개인 수, $$p_{i,t}: \beta_i(t), \gamma_i(t), \rho_i(t)$$는 전파율, 회복률, 사망률을 의미합니다.[1]

**인과 인코더(CE)**: 인과 특성을 노드 임베딩으로 인코딩합니다:[1]

$$
H_t^c = \tanh\left(Q_t W_e^{(t)} + b_e^{(t)}\right) \in \mathbb{R}^{N \times F_c}
$$

**특성 인코더(FE)**: 입력 특성을 인코딩합니다:[1]

$$
H_t^f = \sigma\left(C_t W_f^{(t)} + b_f^{(t)}\right) \in \mathbb{R}^{N \times F_f}
$$

**동적 그래프 인코딩(AGCN)**: 주의 기반 GCN을 이용하여 공간 특성을 학습합니다:[1]

$$
H_t = g\left(A_t \tilde{H}_t W^{(t)} + b^{(t)}\right) \in \mathbb{R}^{N \times F}
$$

여기서 $$A_t = (a_{ij,t})$$는 동적 주의 행렬이며, 다음과 같이 계산됩니다:[1]

$$
a_{ij,t} = v^T g(W_{sc}h_{i,t} + W_{tg}h_{j,t} + b_s) + b_s \in \mathbb{R}
$$

**시간 인코더(TE)**: 현재 시점의 특성들을 결합하여 시간 정보를 캡처합니다:[1]

$$
\dot{H}_t^f = H_t^f W_a^{(t)} + b_a^{(t)}
$$

$$
\dot{H}_t^c = H_t^c W_b^{(t)} + b_b^{(t)}
$$

$$
\dot{H}_{t-1} = H_{t-1} W_c^{(t)} + b_c^{(t)}
$$

$$
\tilde{H}_t = \tanh\left(\left[\dot{H}_t^f \| \dot{H}_t^c \| \dot{H}_{t-1}\right]\right) \in \mathbb{R}^{N \times F}
$$

**인과 디코더(CD)**: 잠재 공간에서 질병 모델 파라미터를 동적으로 추론합니다:[1]

$$
P_t = \sigma\left(\tilde{H}_t W_d^{(t)} + b_d^{(t)}\right) \in \mathbb{R}^{N \times 3}
$$

**출력 층**: 최종 예측을 생성합니다:[1]

$$
\hat{Y} = \phi\left(\left[H_T \| H_{T+h}^c\right] W^o + b^o\right) \in \mathbb{R}^N
$$

**최적화 함수**: 인과 손실과 ADGNN 예측 손실을 결합합니다:[1]

$$
L(\Theta) = \|Y - \hat{Y}\|_1 + \sum_{t=T-K+2}^{T+h} \|Y_t^c - \hat{Y}_t^c\|_1
$$

### 2.3 모델 구조

프레임워크는 다음과 같이 작동합니다:[1]

각 시간 단계 $$t$$에서 그래프 $$G$$는 특성 인코딩(FE), 인과 인코딩(CE), 동적 그래프 인코딩(AGCN), 시간 인코딩(TE), 인과 디코딩(CD), SIRD 계산을 포함한 비선형 변환을 통해 임베딩됩니다.[1]

프로세스는 $$K$$번 반복되며, 마지막 시간 단계에서:
1. 가장 최근의 질병 모델 파라미터 $$P_T$$를 사용하여 SIRD 모델을 $$h-1$$ 단계 더 실행
2. 미래 인과 특성 $$Q_{T+h}$$를 생성
3. 마지막 AGCN 층의 출력과 인과 인코더의 출력을 결합하여 최종 예측 생성

모델의 파라미터 복잡도는 $$O(F \times (F + F_s + c) + F_c \times b + F_f \times (C + a))$$로, **지역 수 $$N$$과 무관합니다**. 이는 다양한 크기의 데이터셋에서 강건한 성능을 가능하게 합니다.[1]

### 2.4 성능 향상

실험 결과는 CausalGNN이 여러 기준선 모델을 능가함을 보여줍니다:[1]

| 데이터셋 | 최단 예측(7일) | 최장 예측(28일) |
|---------|----------------|----------------|
| 전역 | 1911±192 MAE | 3310±58 MAE |
| 미국 주 | 339±13 MAE | 640±51 MAE |
| 미국 카운티 | 21.3±0.4 MAPE | 29.0±0.7 MAPE |

특히 주목할 점은:[1]

- **STAN(이전 최고 성능 모델) 대비**: 전역 28일 예측에서 약 7% 개선
- **가장 가까운 경쟁 모델(Cola-GNN) 대비**: 카운티 데이터셋에서 더욱 안정적인 성능

**절제 연구(Ablation Study)** 결과:[1]
- 단기 예측(7-14일)에서 주의 메커니즘(ATT)의 중요성 최고
- 장기 예측(21-28일)에서 그래프 구조(GRF)의 중요성이 가장 큼
- 인과 모듈(CSL) 제거 시에도 모든 구성에서 성능 저하 확인

***

## 3. 일반화 성능 향상 가능성

### 3.1 파라미터 효율성을 통한 강건한 일반화

CausalGNN의 가장 큰 강점은 **파라미터 수가 지역의 개수에 무관**하다는 점입니다. 이는 다음과 같은 일반화 이점을 제공합니다:[1]

| 모델 | 파라미터 규모 특성 |
|------|-----------------|
| Cola-GNN | $$N^2$$에 비례 (카운티 수준에서 323배 증가) |
| CNNRNN-Res | $$N^2$$에 비례 (카운티 수준에서 202배 증가) |
| **CausalGNN** | **상수 (0.97배 유지)** |

이러한 효율성은 과적합 위험을 크게 감소시킵니다. 특히 전염병 데이터가 교통 데이터보다 희소하고 노이즈가 많은 환경에서 중요합니다.[1]

### 3.2 역학적 문맥의 통합을 통한 일반화 개선

CausalGNN은 역학적 기초를 모델에 직접 포함함으로써 일반화 성능을 향상시킵니다:[1]

**SIRD 모델의 역할**:
- 데이터 기반 학습이 과하게 데이터 특이성에 치우치는 것을 방지
- 질병 전파의 생물학적으로 타당한 제약 조건 제공
- 희소 데이터 환경에서 정규화 효과

**실제 사례**:
- Poland, Massachusetts, Carroll County 예제에서 CausalGNN은 CausalGNN w/o csl(인과 모듈 제거)보다 일관되게 더 나은 예측 생성[1]
- 인과 모듈이 생성한 주황색 곡선이 실제 진실(검은색 곡선)과 의미 있는 상관관계 보유[1]

### 3.3 적응형 그래프 구조를 통한 동적 일반화

전통적인 지리적 인접 행렬 대신 **동적 주의 행렬**을 사용함으로써:[1]

- 시간에 따라 변화하는 질병 역학을 반영
- 고정된 네트워크 구조의 한계 극복
- 이동 데이터에 의존하지 않아도 적응형 연결성 학습

### 3.4 다중 해상도 데이터셋에서의 강건성

동일한 모델 아키텍처로 다양한 해상도에서 일관된 성능 달성:[1]

- **전역 수준**: 93개 국가
- **국가 수준**: 52개 미국 주
- **지역 수준**: 1,351개 미국 카운티

이는 전이 학습(Transfer Learning)이나 도메인 적응(Domain Adaptation)에 높은 가능성을 시사합니다.[1]

***

## 4. 모델의 한계

### 4.1 구조적 한계

**단일 구획 SIRD 모델의 제약**: 논문이 각 지역에 대해 독립적인 SIRD 모델을 사용하므로, 지역 간 직접적인 이동성 모델링이 제한적입니다. 네트워크 기반 SEIR 모델과 달리 지역 간 상호작용은 GNN을 통해서만 학습됩니다.[1]

**변수 간 독립성 가정**: 현재 모델은 단일 대상(일일 확진 사례 수)에 초점을 맞추고 있으며, 확인된 사례, 사망, 회복 사례 간의 다중 목표 학습(Multi-task Learning)을 고려하지 않습니다.[1]

### 4.2 데이터 의존성

**시간 윈도우의 제약**: 고정된 역사 윈도우 $$K = 28$$을 사용하는데, 서로 다른 질병이나 변이체에 최적의 윈도우가 다를 수 있습니다.[1]

**초기 데이터 부족**: COVID-19 초기 확산 단계의 희소 데이터에서는 모델 성능이 제한될 수 있습니다.[1]

### 4.3 해석가능성 한계

**블랙박스 특성**: GNN의 임베딩이 어떤 공간적 패턴을 정확히 포착하는지 직관적으로 이해하기 어렵습니다.[1]

**인과 파라미터의 해석**: 신경망을 통해 추론된 $$\beta_i(t)$$, $$\gamma_i(t)$$, $$\rho_i(t)$$가 실제 역학적 의미를 유지하는지 완전히 검증되지 않았습니다.[1]

---

## 5. 향후 연구에 미치는 영향 및 고려사항

### 5.1 즉각적인 영향

**인과성과 데이터 기반 학습의 통합**: CausalGNN은 도메인 지식과 딥러닝의 결합이 효과적일 수 있음을 입증하며, 다른 과학 분야(기후 모델링, 교통 예측 등)에서 유사한 접근법을 시도하도록 영감을 줍니다.[1]

**그래프 신경망의 설계 원칙**: 파라미터 효율성을 유지하면서 도메인 지식을 통합하는 방법은 향후 GNN 연구의 모범 사례가 될 것입니다.[1]

### 5.2 향후 연구 방향

논문에서 제시된 향후 연구 과제:[1]

1. **다중 목표 학습(Multi-task Learning)**: 확진 사례, 사망, 회복을 동시에 예측하는 통합 모델
2. **반사실적 예측(Counterfactual Forecasting)**: "만약 개입이 없었다면"과 같은 정책 평가
3. **모델 해석가능성 강화**: 학습된 모델의 신경망 의사결정 과정에 대한 깊이 있는 분석

### 5.3 실무적 고려사항

**배포 시 고려사항**:
- 모델의 작은 파라미터 크기는 실시간 예측에 유리하며 모바일 환경에서도 배포 가능[1]
- 새로운 지역이나 국가로 확장할 때 추가 학습량 최소화[1]

**데이터 품질**:
- 서로 다른 보고 지연(Reporting Lag)과 테스트 편향을 고려한 데이터 전처리 필요[1]
- 일반화된 모델의 효과적인 사용을 위해 지역별 보정(Calibration) 전략 개발[1]

**정책 적용**:
- 장기 예측(21-28일) 성능 개선으로 보건 정책 입안자들이 장기 개입을 계획하는 데 더 효과적[1]
- 인과 모듈을 통해 정책 시뮬레이션이 가능하여 증거 기반 의사결정 지원[1]

***

## 결론

CausalGNN은 **전염병 예측에서 기계 학습의 적응성과 인과 모델의 해석가능성을 결합**한 중요한 진전을 대표합니다. 특히 매개변수 효율성을 유지하면서 다양한 지역 규모에서 일관된 성능을 달성하는 방식은 미래의 시공간 예측 연구에 새로운 방향을 제시합니다. 역학적 문맥의 명시적 통합이 과적합을 방지하고 장기 예측 성능을 개선한다는 발견은 다른 과학 분야에서도 도메인 지식 기반 심층학습 설계의 가치를 강조합니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/83787036-5f8b-4fd7-b3ee-7ea186698094/21479-Article-Text-25492-1-2-20220628.pdf)
