# Scaleformer: Iterative Multi-scale Refining Transformers for Time Series Forecasting

**핵심 주장 및 주요 기여**  
Scaleformer는 기존 시계열 예측용 트랜스포머 모델(FEDformer, Autoformer, Informer 등)에 “다중 해상도 반복 정제(Multi-scale Iterative Refinement)” 구조와 “교차 스케일 정규화(Cross-scale Normalization)”를 결합함으로써, 최소한의 연산 오버헤드로 평균 제곱 오차(MSE)를 5.5%에서 최대 38.5%까지 대폭 감소시킨다는 점을 주장한다. 주요 기여는 다음과 같다:[1]
- 새로운 반복적 다중 스케일 정제 패러다임 도입  
- 스케일 간 분포 이동을 완화하는 교차 스케일 정규화 기법 제안  
- 다양한 트랜스포머 백본에 범용적으로 적용 가능함을 실험으로 입증  
- 적응형 손실(adaptive loss)을 통한 이상치 강인성 강화  
- 세부 구성요소 효과를 확인하는 광범위한 소거 연구(ablation study)  

***

## 1. 해결하고자 하는 문제  
시계열 데이터는 계절성·추세성 등이 서로 다른 여러 시간 해상도를 내포한다. 기존 트랜스포머 기반 모델들은 주로 복잡도 저감 또는 구조 변형에 집중했으나, 명시적 다중 해상도 인식 구조(scale-awareness)를 충분히 반영하지 못했다. 이로 인해:  
- 장단기 패턴을 모두 학습하는 데 한계  
- 다운샘플링·업샘플링 과정에서 예측 오차가 스케일 간에 누적되어 성능 저하  

***

## 2. 제안하는 방법

### 2.1 문제 설정  
- 과거 관측 윈도우 $$X_L \in \mathbb{R}^{L \times d_x}$$를 입력으로, 이후 $$H$$ 시점의 미래 $$X_H\in \mathbb{R}^{H\times d_x}$$를 예측하는 시계열 포캐스팅 문제이다.

### 2.2 다중 스케일 반복 정제 프레임워크  
1. 여러 스케일 집합 $$S=\{s_m,\dots,s_1,1\}$$을 정의 (기본적으로 $$s=2$$인 $$2^k$$ 스케일)  
2. 각 스케일 단계 $$i$$에서  
   - 인코더 입력: $$X_L$$을 $$s^{m-i}$$로 다운샘플링  
   - 디코더 입력: 이전 단계 예측 $$X_{\text{out}}^{(i-1)}$$을 $$s$$로 업샘플링  
   - 동일 가중치의 트랜스포머 모듈 $$F$$로 정제  
   - 수식:  

$$
       X_L^{(i)} = \mathrm{AvgPool}(X_L,\;s^{m-i}),\quad
       X_{\text{dec}}^{(i)} = \begin{cases}
         0, & i=0,\\
         \mathrm{Upsample}(X_{\text{out}}^{(i-1)},\,s), & i>0
       \end{cases}
     $$

$$
       X_{\text{out}}^{(i)} = F\bigl(\mathrm{Norm}(X_L^{(i)},X_{\text{dec}}^{(i)})\bigr)
     $$  

3. 최종 스케일의 출력을 합산하여 예측

### 2.3 교차 스케일 정규화  
각 단계 $$i$$에서 인코더·디코더 입력의 시계열 평균을 결합해 기준 분포를 계산한 뒤, 해당 값으로 출력 분포를 정규화함으로써 다운샘플링·업샘플링 과정에서 발생하는 분포 이동을 억제한다.[1]

### 2.4 적응형 손실 함수  
전통적 MSE 대신 Barron’s 적응형 손실(adaptive loss)을 사용하여 이상치에 강인하게 학습하며, 손실 민감도 매개변수 $$\alpha$$와 스케일 $$c$$를 학습한다.[1]

***

## 3. 모델 구조  
- 트랜스포머 인코더·디코더 블록을 스케일 단계마다 반복 사용(가중치 공유)  
- 입력 임베딩: 값 임베딩, 스케일 정보 포함 시계열 임베딩, 위치 임베딩  
- 출력 정규화: 스케일별 분포 이동 완화  
- 손실: 적응형 손실 + MSE 조합

***

## 4. 성능 향상 및 한계

### 4.1 성능  
- 주요 공개 데이터셋(전력·교통·날씨·환율·인플루엔자 등)에서  
  - FEDformer, Autoformer, Informer 대비 MSE 5.5–38.5% 감소  
  - MAE 역시 전반적 개선  
- 최소 추가 파라미터 및 2배 미만의 연산 오버헤드  
- 광범위한 소거 연구로 각 구성요소 유효성 확인[1]

### 4.2 한계  
- 연속적 다중 스케일 단계로 인해 계산 비용 증가  
- 분포가 다중 모달인 데이터에서는 정규화 방식(평균만 vs. 평균·표준편차) 선택이 성능에 민감  
- 비트랜스포머 기반 모델(NHits, FiLM) 적용 시 구조 적응 필요성

***

## 5. 일반화 성능 향상 관점  
- **스케일 인식 구조**가 장·단기 패턴 학습에 명시적 기여  
- **교차 스케일 정규화**로 분포 이동에 따른 과적합 억제  
- **적응형 손실**이 반복적 예측에서 누적 오차 이상치를 완화  
- 비확률적·확률적 예측(DeepAR) 환경 모두에서 유효하여 일반화 가능성 높음

***

## 6. 향후 연구에 미치는 영향 및 고려사항  
- 다양한 백본 아키텍처(비트랜스포머·비점증 폭발 모델)로 확장 가능성  
- 정규화 방식 및 단계별 스케일 집합 최적화 연구  
- 확률적 예측·불확실성 정량화 연구와 결합  
- 경량화와 효율성 균형을 위한 단계별 스케일 인터폴레이션 기법  
- 시계열 변칙 탐지·교차 영역 시계열 예측에도 응용 가능성  

이와 같이 Scaleformer는 시계열 예측 모델에 구조적 스케일 인식을 도입하고, 분포 이동·이상치를 체계적으로 다룸으로써 예측 정확도와 일반화 가능성을 크게 향상시키는 새로운 패러다임을 제시한다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/2d20fb0b-af00-4615-bccf-adb042a918e3/2206.04038v4.pdf)
