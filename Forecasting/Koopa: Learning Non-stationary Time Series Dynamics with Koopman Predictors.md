# Koopa: Learning Non-stationary Time Series Dynamics with Koopman Predictors

## 1. 핵심 주장과 주요 기여

본 논문의 **핵심 주장**은 기존 딥러닝 모델들이 비정상적(non-stationary) 시계열 예측에서 겪는 한계를 현대 쿠프만 이론(Koopman theory)을 활용하여 근본적으로 해결할 수 있다는 것입니다.[1]

**주요 기여**는 다음과 같습니다:

1. **Koopman 이론 기반 접근법**: 시변(time-variant)과 시불변(time-invariant) 동역학을 계층적으로 분리하고 활용하는 새로운 Koopa 모델 제안[1]

2. **모듈형 Fourier Filter와 Koopman Predictor**: 주파수 영역 통계를 활용한 동역학 분리와 각각의 동역학을 처리하는 모듈형 예측기 설계[1]

3. **뛰어난 효율성**: 최첨단 모델 대비 **77.3% 훈련 시간 단축**과 **76.0% 메모리 절약**을 달성하면서 경쟁력 있는 성능 유지[1]

## 2. 해결 문제, 제안 방법 및 모델 구조

### 해결하고자 하는 문제
비정상적 시계열의 **시변 통계와 시간적 종속성**이 서로 다른 기간에서 나타나 훈련과 추론 간 거대한 분포 격차를 만드는 문제입니다. 기존 모델들은 이러한 시변 특성을 자연스럽게 다룰 이론적 기반이 부족했습니다.[1]

### 제안 방법 (수식 포함)

**1) Koopman 이론 기반 접근**
비선형 동적 시스템 $$x_{t+1} = F(x_t)$$를 측정 함수 공간에서 선형 연산자로 변환:

$$K g(x_t) = g(F(x_t)) = g(x_{t+1})$$[1]

**2) Fourier Filter를 통한 동역학 분리**

$$X_{inv} = \mathcal{F}^{-1}(\text{Filter}(\mathcal{G}, \mathcal{F}(X)))$$

$$X_{var} = \mathcal{F}^{-1}(\text{Filter}(\overline{\mathcal{G}}, \mathcal{F}(X))) = X - X_{inv}$$[1]

**3) Time-invariant KP**
전역적으로 학습된 연산자:

$$Z_{back} = \text{Encoder}(X_{inv})$$

$$Z_{fore} = K_{inv}Z_{back}$$

$$Y_{inv} = \text{Decoder}(Z_{fore})$$[1]

**4) Time-variant KP**
지역적으로 계산된 연산자:

$$K_{var} = Z_{fore}Z_{back}^{\dagger}$$[1]

### 모델 구조
Koopa는 **적층 가능한 Koopa Block들**로 구성되며, 각 블록은:
- **Fourier Filter**: 주파수 영역에서 시변/시불변 성분 분리
- **Time-invariant KP**: 전역 공유 동역학 처리
- **Time-variant KP**: 지역화된 동역학 처리
- **Deep Residual Structure**: 이전 블록의 잔차를 다음 블록 입력으로 사용[1]

## 3. 성능 향상 및 한계

### 성능 향상
1. **예측 성능**: 6개 실제 데이터셋에서 70% 이상의 다변량 설정에서 최첨단 성능 달성[1]
2. **효율성**: PatchTST 대비 평균 **22.7% 훈련 시간**과 **24.0% 메모리** 사용량으로 동등하거나 더 나은 성능[1]
3. **확장성**: 입력된 실제 값을 활용한 연산자 적응을 통해 예측 범위 확장 가능[1]

### 한계
1. **다변량 처리**: 서로 다른 변수들의 동역학을 개별적으로 고려하지 않아 다변량 예측에서 개선 여지 존재[1]
2. **Koopman 스펙트럼 이론 활용 부족**: 고차원 표현에서 선형 행동을 해석할 수 있는 Koopman 모드 발견 미활용[1]
3. **공변량 처리**: 시스템 외부 요인을 고려하는 제어용 Koopman 이론 미적용[1]

## 4. 모델의 일반화 성능 향상 가능성

본 모델의 **일반화 성능 향상 가능성**은 매우 높습니다:

### 이론적 근거
1. **Koopman 이론의 수학적 기반**: 시변 동역학에 대해 좌표 변환이 존재하여 전체 측정 함수 공간을 선형화된 여러 부공간으로 나눌 수 있다는 이론적 보장[1]

2. **계층적 동역학 학습**: 각 블록이 약정상 과정을 계층적으로 학습하고 다음 블록에 잔차를 전달하여 복잡한 비정상 과정을 안정적 연산자들의 집합으로 구성[1]

### 실증적 증거
1. **Operator 적응 능력**: 들어오는 실제 값을 활용하여 시변 동역학을 더 정확하게 적합시키며, 비정상성이 클수록 성능 향상 효과가 더 크게 나타남[1]

2. **안정성**: 분해와 깊은 잔차 구조를 통해 연산자의 고유값이 단위원에 더 가까워져 장기 예측에서 안정성 확보[1]

## 5. 향후 연구 영향 및 고려사항

### 향후 연구에 미치는 영향

**긍정적 영향:**
1. **이론적 토대 제공**: 비정상 시계열에 대한 자연스러운 이론적 접근법으로 향후 연구의 새로운 방향 제시[1]
2. **효율성 패러다임**: 성능을 유지하면서 대폭적인 계산 효율성 개선으로 실용적 응용 가능성 확대[1]
3. **모듈형 설계**: 계층적 동역학 학습과 분리 메커니즘이 다른 시계열 문제에도 적용 가능[1]

### 앞으로 연구 시 고려할 점

**기술적 고려사항:**
1. **다변량 확장**: 변수별 진화 패턴과 시계열 관계를 고려한 향상된 다변량 예측 연구 필요[1]
2. **스펙트럼 분석 활용**: Koopman 스펙트럼 이론을 완전히 활용하여 동적 모드 발견 및 해석성 향상[1]
3. **제어 이론 통합**: 시스템 외부 요인을 고려하는 공변량 기반 예측으로 확장[1]

**실용적 고려사항:**
1. **하이퍼파라미터 민감성**: 변수가 많은 데이터셋에서 세그먼트 길이 S에 대한 민감성 해결[1]
2. **안정성 보장**: 복잡한 비정상 시계열에서 연산자 수렴 문제에 대한 추가적 안정화 기법 개발[1]

이 연구는 시계열 예측 분야에서 **이론적 근거와 실용적 효율성을 모두 만족하는 혁신적 접근법**으로, 향후 비정상 시계열 처리 연구의 중요한 기준점이 될 것으로 예상됩니다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/a0f2077d-646a-4721-a85e-2273620ea7b9/2305.18803v2.pdf)
