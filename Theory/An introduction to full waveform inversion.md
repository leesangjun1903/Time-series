# An introduction to full waveform inversion

# 핵심 요약

**“An Introduction to Full Waveform Inversion”**(Virieux et al., 2017)은 지진파의 전체 시간을 고려하여 물질 속성(예: 속도, 임피던스 등)을 고해상도로 재구성하는 **Full Waveform Inversion(FWI)** 기법을 체계적으로 정리하고,[1]
1) 기존 편광(phase-by-phase) 기반 이미징 한계를 극복하고, 모든 파형(직파·반사·산란)을 동일한 단일산란(single-scattering) 가정 하에 활용하여 매끄러운 저주파 및 세부 고주파 성분을 동시에 복원  
2) 최적화 관점(Leasts-Squares / Newton, Gauss-Newton)과 수치파동전파(forward modeling) 관점(1차/2차 하이퍼볼릭 PDE)에서 FWI 워크플로우를 통합  
3) 초기 모델 설계, 사이클 스키핑(cycle-skipping) 극복 전략, 불확실도·해상도 분석, 다중파라미터(속도·밀도·감쇠·이방성) 확장 가능성 등을 종합적으로 고찰  
등을 주요 기여로 제시한다.[1]

***

## 1. 문제 제기 및 한계  
– **전통적 토모그래피·마이그레이션** 은 파(phase)별(직파·반사·표면파)로 분리해 저주파(매끄러운 구조)와 고주파(날카로운 구조)를 개별 처리하면서, “중간파수대 대역”(wavenumber gap)이 존재.[1]
– 파해석·피킹 오류, 파왜곡(scattering) 등을 감안하면 반사·산란 성분은 종종 배제 혹은 국소적(주파수별·대역별) 처리되어 정보 활용도가 제한됨.  
– FWI의 **사이클 스키핑** 문제: ℓ₂ misfit으로 진동 신호를 직접 비교할 때 초기 모델 오차가 반파기 이상이면 국소 최소치에 갇힐 위험.  
– 다중파라미터 동시 추정 시 **파라미터 간 crosstalk**(속도⇄밀도)으로 해상도·정밀도 저하.

***

## 2. 제안 방법

### 2.1 단일산란(single-scattering) 기반 전파 모델링  
– 진폭·위상 변화 모두 포함해 파형 전체를 매끄러운 배경+국소 산란점(픽셀)으로 선형 근사  
– 1차 하이퍼볼릭 시스템(속도–응력) 또는 2차 하이퍼볼릭 시스템(변위 또는 속도만)으로 기술[1]
– 주파수 도메인·시공간 도메인 모두 적용 가능

### 2.2 최적화 프레임워크  
– 비선형 최소자승 문제:  

$$
\min_m C(m)=\tfrac12\sum_{s,r}\int_0^T\|d^{\rm syn}(m;x_s,x_r,t)-d^{\rm obs}(x_s,x_r,t)\|^2\,dt
$$  

– 뉴턴·Gauss–Newton(제6식) 근사로 업데이트  
– 그라디언트(제27식): 포워드 파동-역방향 파동(어드조인트) 교차상관(cross-correlation) 형태로 효율 계산  
– 2차 어드조인트로 Hessian-vector 곱 산출 가능[1]

### 2.3 사이클 스키핑 극복  
– **Misfit 함수 재설계**: 위상 전용, 엔벨로프, 변동률(dynamic warping), 0-lag 상관, 디컨볼루션, 최적 운송 거리 등[1]
– **모델 공간 확장**: 시공간 오프셋·시간 시프트 추가 파라미터화(Joint FWI)[1]
– **Imp(임피던스)/Vel(속도) 분리**: 저주파 속도와 고주파 임피던스를 교대로 복원하는 전략으로 주상관 저감(JFWI)[1]

***

## 3. 모델 일반화 성능 향상 전략

1. **모델 구속(model-driven)**  
   – 기존 토모·지질·지구물리 로그 등 사전 정보를 ℓ₂ 정규화 항(제38식)으로 추가[1]
   – 가중치 행렬로 불확실도·획득 기하학 반영, 잘 로그 인접에 낮은 분산·심도 증가 분산 설계  
   – 동적 하이퍼파라미터 조정으로 초기 안정→최종 데이터 주도 전환  
   – 합성 예제에서 가스층 두 군데 모두 복원 성공
2. **다중파라미터(FWI) 안정화**  
   – 파라미터 방사 패턴 분석→획득 구성(illumination) 설계로 crosstalk 저감[1]
   – Gauss–Newton Hessian 블록 대각 근사→로컬 decoupling 전처리[1]
   – 대규모에선 l-BFGS·Truncated-Newton + 블록 대각 프리콘디셔너 활용 권장[1]

***

## 4. 주요 성능 및 한계  
– **해상도 대폭 향상**: Valhall 해저 OBC 데이터에서 paleoriver·빙하 자국·가스 클라우드 정밀 복원[1]
– **초기 모델 의존성**: 매끄러운 모델 설계 실패 시 고해상도 성분 잘못 복원(cycle-skipping)  
– **컴퓨팅 비용**: 3D 탄성 해석·다중파라미터 동시 추정 시 연산·메모리 급증  
– **불확실도 정량화**: Hessian 직접 사용 어려워 의사불확실도(ensemble) 필요

***

## 5. 향후 연구 영향 및 고려사항

- **실용적 확장**: 3D 탄성·관측파라미터(밀도·감쇠·이방성) 동시 복원 → 생산성·정밀도 확보  
- **AI·최적화 결합**: 딥러닝 예비모델→FWI로 국소 최소 극복·속도 개선  
- **불확실도 정량화**: 저순위 랜덤 화·Ensemble Kalman→신뢰구간 계산  
- **사전 정보 통합**: 유정·지질 정보 자동 반영, 하이퍼파라미터 자동 튜닝  
- **극한 데이터 조건**: 잡음·불완전 획득 → 강인한 misfit 설계 및 전처리 기법 연구

FWI는 앞으로 고해상도 지하영역 영상화를 위한 기본 도구로 자리매김하며, 대규모 다중파라미터·탄성 모형·불확실도 정량화 연구가 필수적이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/cb5f7dd0-df63-4d99-8275-1758c35221b9/6-An-introduction-to-full-waveform-inversion.pdf
