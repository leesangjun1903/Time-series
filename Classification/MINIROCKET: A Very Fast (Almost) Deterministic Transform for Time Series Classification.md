# MINIROCKET: A Very Fast (Almost) Deterministic Transform for Time Series Classification

### 핵심 주장 및 주요 기여

MiniRocket은 **시계열 분류 문제를 해결하기 위해 Rocket을 재구성하여 계산 효율성을 극적으로 개선**한 방법입니다. 논문의 핵심 주장은 다음과 같습니다:[1]

**주요 기여:**

1. **성능과 속도의 획기적 개선**: MiniRocket은 Rocket 대비 최대 75배 빠르면서도 거의 동일한 정확도를 유지합니다. 109개의 UCR 데이터셋 전체에 대해 10분 이내에 학습과 테스트를 완료할 수 있습니다.[1]

2. **결정론적 변환의 가능성**: 무작위 커널을 사용하는 Rocket과 달리, MiniRocket은 거의 완전히 결정론적(거의 모든 과정이 고정된)이면서도 높은 정확도를 달성할 수 있음을 입증합니다.[1]

3. **계산복잡도 대비 정확도 우월성**: 비교 가능한 정확도의 다른 방법들(HIVE-COTE, TS-CHIEF 등)과 비교하면 월등히 빠르며, 유사한 계산 비용의 방법들과 비교하면 훨씬 정확합니다.[1]

---

### 해결 문제 및 제안 방법

#### 문제 정의

시계열 분류는 **높은 계산복잡도와 확장성 부족**이라는 근본적인 문제를 안고 있었습니다. 기존의 정확한 방법들(HIVE-COTE 등)은 109개 데이터셋 처리에 수 주일이 필요했습니다.[1]

#### 제안 방법: 핵심 개선사항

MiniRocket의 변환 과정은 다음 수식으로 표현됩니다:

**기본 변환:**

$$C = X * W_d$$

여기서 $$X$$는 시계열, $$W$$는 커널, $$d$$는 dilation입니다.

**PPV (Proportion of Positive Values) 계산:**

$$\text{PPV}(X * W - b) = \frac{1}{n}\sum_{i=1}^{n}[X * W - b > 0]$$

**주요 설계 변경사항**:[1]

| 요소 | Rocket | MiniRocket |
|------|--------|-----------|
| 커널 길이 | {7, 9, 11} (무작위) | 9 (고정) |
| 커널 가중치 | N(0, 1) (정규분포) | {-1, 2} (이진값) |
| 편향(Bias) | U(-1, 1) (균등분포) | 합성곱 출력에서 샘플링 |
| Dilation | 무작위 | 입력길이에 상대적인 고정값 |
| 특징 | PPV + max 풀링 | PPV만 사용 |
| 총 특징 수 | 20,000 | 10,000 |

**MiniRocket은 총 84개의 고정 커널만 사용**합니다. 이는 $$2^9 = 512$$개의 이진 커널 중에서 정확히 3개의 β 가중치를 가진 커널들을 선택한 것입니다.[1]

---

### 모델 구조 및 최적화

#### 구조적 특징

MiniRocket의 모델 구조는 네 가지 주요 최적화를 통해 효율성을 달성합니다:[1]

**1. PPV와 -W에 대한 동시 계산:**

PPV가  범위에 있으므로:[1]

$$\text{PPV}(X * W - b) = 1 - \text{PPV}(b - (X * (-W)))$$

따라서 하나의 커널 $$W$$에 대한 계산으로 동시에 $$-W$$에 대한 특징도 얻어집니다.[1]

**2. 합성곱 출력 재사용:**

$$C = X * W_d$$

동일한 합성곱 출력 $$C$$를 여러 편향값에 대해 재사용하여 PPV를 계산합니다.[1]

**3. 곱셈 제거:**

이진 가중치 {α = -1, β = 2}를 사용하면, 사전에 $$A = \alpha X = -X$$와 $$B = \beta X = 2X$$를 계산한 후, 합성곱을 **덧셈만으로** 수행할 수 있습니다:[1]

$$X * W = \sum_{j=0}^{m-1} x_{i-(⌊m/2⌋·d)+(j·d)} · w_j$$

를 다음과 같이 변환:

```math
\hat{C} = \begin{bmatrix} 0 & 0 & \cdots & 0 & a_0 & \cdots \\ 0 & 0 & \cdots & b_0 & b_1 & \cdots \\ 0 & a_0 & a_1 & a_2 & \cdots \\ \vdots & \vdots & \vdots & \vdots & \vdots \end{bmatrix}
```

**4. 모든 84개 커널을 거의 한 번에 계산:**

$$γ = 3$$이고 $$β = α + γ$$이므로:

$$C = C_α + C_γ$$

$$C_α$$는 모든 커널에 대해 공유되고, 각 커널에 대해서는 $$C_γ$$만 추가로 계산하면 됩니다.[1]

#### Dilation 전략

Dilation은 다음과 같이 동적으로 결정됩니다:[1]

$$D = \{⌊2^0⌋, ⌊2^{x}⌋, \ldots, ⌊2^{x_{max}}⌋\}$$

여기서 $$x_{max} = \frac{\log_2(l_{input} - 1)}{l_{kernel} - 1}$$이며, 지수는 0과 $$x_{max}$$ 사이에 균등하게 분포합니다.[1]

#### 시간복잡도

형식적으로 $$O(k \cdot n \cdot l\_{input})$$ 의 시간복잡도를 유지하지만, 위의 네 가지 최적화를 통해 실제 상수항을 극적으로 감소시킵니다.[1]

***

### 성능 향상 및 일반화

#### 정확도 성능

실험 결과:[1]

- MiniRocket은 Rocket 대비 **평균적으로 미세하게 더 높은 정확도** 달성 (61개 데이터셋에서 더 우수, 45개에서 더 낮음)
- 가장 정확한 방법들(TS-CHIEF, HIVE-COTE/TDE)과의 정확도 차이는 통계적으로 유의미하지 않음
- UCR 아카이브 기준으로 평균 순위 3.5위 (약 9개 방법 중)

#### 속도 성능[1]

| 데이터셋 | 크기 | 속도 향상 |
|---------|------|---------|
| FruitFlies | 17,259 × 5,000 | **66배** |
| InsectSound | 25,000 × 600 | **43배** |
| MosquitoSound | 139,780 × 3,750 | **75배** |
| DucksAndGeese (길이 비교) | 50 × 236,784 | **19배** |

전체 109개 데이터셋에 대한 Rocket의 총 계산시간이 **약 2시간**인 반면, MiniRocket은 **약 8분**입니다.[1]

#### 일반화 성능 분석

**결정론적 변형 (MiniRocketDV)의 성능**:[1]

기본 MiniRocket은 편향값 샘플링 시 무작위로 선택된 하나의 훈련 데이터를 사용합니다(기술적으로 유일한 확률적 요소). 완전 결정론적 변형(MiniRocketDV)은 전체 훈련 집합의 분위수를 사용하며:

- 42개 데이터셋에서 더 나음, 11개에서 동등, 56개에서 더 낮음
- **정확도 차이는 무시할 수 있는 수준**
- 이는 높은 정확도를 유지하면서 완전히 결정론적인 변환이 가능함을 증명

**일반화 성능 향상 가능성**:[1]

1. **매개변수 감수성 분석:**
   - 커널 길이 7, 9, 11 모두 유사한 정확도 (길이 9가 최적)
   - 편향 샘플링 방식 변경이 **가장 중요한 요소** (U(-1,1) 대비 합성곱 출력 샘플링이 현저히 우수)
   - 특징 수 10,000까지 정확도 증가, 그 이상에서는 개선 미미
   - Max 풀링 제거가 성능에 긍정적 영향

2. **확장성의 우수성:**
   - 시계열 길이 증가 시에도 선형 시간복잡도 유지
   - 훈련 집합 크기에 무관하게 동일한 하이퍼파라미터 사용 가능
   - 메모리 오버헤드 최소 (약 52MB, 100만 길이 시계열 기준)

***

### 모델의 한계

**주요 한계점**:[1]

1. **다변량 시계열 처리의 미흡:**
   - 현재는 단순한 나이브 접근법만 제공
   - 다변량 시계열의 채널 간 의존성을 효과적으로 포착하지 못함

2. **선형 분류기의 제약:**
   - Ridge 회귀 또는 로지스틱 회귀만 사용
   - 복잡한 비선형 관계 학습 불가능

3. **편향 샘플링의 확률성:**
   - 기본 구현에서 무작위 훈련 데이터 선택으로 인한 재현성 문제
   - 결정론적 변형은 대규모 데이터셋에서 비실용적

4. **특정 데이터셋에서의 불안정성:**
   - PigAirwayPressure 같은 일부 데이터셋에서 편향 샘플링 방식의 민감성 관찰

5. **시계열 길이 제한:**
   - 매우 긴 시계열(예: 백만 이상)의 경우, 특징 중복 가능성 증가

***

### 앞으로의 연구 영향 및 고려사항

#### 기대되는 연구 영향

1. **시계열 분석 패러다임의 전환:**
   - 무작위 커널의 유효성을 입증하면서도, 고정된 커널로도 동일한 성능 달성 가능을 보임
   - **간단성과 효율성의 새로운 균형점** 제시

2. **대규모 시계열 분석의 실용화:**
   - 수 주일 필요한 HIVE-COTE 대비 단 분 단위 처리로 엔터프라이즈 적용 가능

3. **이진 가중치 기반 방법론의 확산:**
   - CNN, RNN 등 다른 신경망 구조에 유사 최적화 기법 적용 가능성

#### 향후 연구 시 고려할 점[1]

**저자가 명시한 미래 방향:**

1. **다변량 시계열 처리 개선:**
   - 채널 간 상호작용을 포착하는 정교한 접근법 개발

2. **비선형 분류기 통합:**
   - MiniRocket 특징과 신경망 분류기 결합
   - 앙상블 방법의 도입

3. **다양한 도메인 확장:**
   - 시계열 데이터 외에도 다른 데이터 타입에 적용

**추가 연구 제안:**

- **적응적 매개변수 튜닝**: 데이터셋 특성에 맞는 동적 커널 길이/개수 결정
- **전이 학습**: UCR 아카이브의 소규모 데이터셋으로 사전학습된 특징 활용
- **모듈화된 구조**: 특정 시계열 특성(계절성, 추세 등)에 맞춘 커널 부분집합 선택

***

### 결론

MiniRocket은 **간단함(단 84개 고정 커널)과 효율성(75배 속도 향상)을 동시에 달성**하면서 SOTA 정확도를 유지한 획기적 방법입니다. 특히 완전 결정론적 변형의 가능성을 입증함으로써 재현성이 중요한 산업 환경에서의 신뢰성을 확보했습니다. 향후 다변량 시계열 처리와 비선형 분류기 통합을 통해 적용 범위를 확장할 수 있을 것으로 예상됩니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/d78c6f70-7296-4a08-9818-2d6c19c96f86/2012.08791v2.pdf)
